{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "1_RN15s5pleN"
      },
      "source": [
        "# Intelligent Recommendation System for B2B Based on Deep Learning\n",
        "\n",
        "This code is an intelligent recommendation system from an anonymous U.S. beverage distributor, provided by the Hackathon Forecast Big Data 2025 event, using a 2022 sales history as basis.\n",
        "\n",
        "\n",
        "---\n",
        "\n"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "At first, Here is all imported frameworks and libraries."
      ],
      "metadata": {
        "id": "Mi8LnZY99neP"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "BsDxJEDOZNSW"
      },
      "outputs": [],
      "source": [
        "# Here's included all used frameworks and libraries\n",
        "import gdown\n",
        "import pyarrow as pa\n",
        "import pyarrow.parquet as pq\n",
        "import pandas as pd\n",
        "import numpy as np\n",
        "from datetime import datetime\n",
        "from google.colab import files\n",
        "import random\n",
        "import matplotlib.pyplot as plt\n",
        "import seaborn as sns"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "# 1) Data Ingestion and Preparation\n",
        "\n",
        "For this phase We'll use the ETL (Extraction, Transformation and Load) approach, including mainly pandas!"
      ],
      "metadata": {
        "id": "AvD5fLJAG_8n"
      }
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "-Sxvq3AUpkcF"
      },
      "source": [
        "## 1.1) Extraction"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "We'll start reading the three Parquet files and converting to pandas dataframe."
      ],
      "metadata": {
        "id": "ZG0desIO9xfx"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# File links\n",
        "url1 = \"https://drive.google.com/uc?id=1syHM1B5loX_OVXeiJ_5dl1oAKxo0oL2D\"\n",
        "url2 = \"https://drive.google.com/uc?id=1gI0SQI1cYXLtbttcu6tNqLZjk8bXAUod\"\n",
        "url3 = \"https://drive.google.com/uc?id=1K4KrT8InCbHs2EDOb6SDaVhJ00ShcRq0\"\n",
        "# Output files names\n",
        "fl1, fl2, fl3 = \"sales_transactions.parquet\", \"products_catalog.parquet\", \"sales_points.parquet\"\n",
        "\n",
        "# Download the file tp the disk\n",
        "rq1 = gdown.download(url1, fl1, quiet=False)\n",
        "rq2 = gdown.download(url2, fl2, quiet=False)\n",
        "rq3 = gdown.download(url3, fl3, quiet=False)\n",
        "\n",
        "# Read the Parquet files localy\n",
        "tb1, tb2, tb3 = pq.read_table(fl1), pq.read_table(fl2), pq.read_table(fl3)\n",
        "# Transform files into dataframes\n",
        "df1, df2, df3 = tb1.to_pandas(), tb2.to_pandas(), tb3.to_pandas()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "BXDBXBuLaOh7",
        "outputId": "fc25c9c4-34c6-4a52-ca87-1ea76bd46519"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "Downloading...\n",
            "From (original): https://drive.google.com/uc?id=1syHM1B5loX_OVXeiJ_5dl1oAKxo0oL2D\n",
            "From (redirected): https://drive.google.com/uc?id=1syHM1B5loX_OVXeiJ_5dl1oAKxo0oL2D&confirm=t&uuid=cd35d54a-f7cd-4a47-88af-91ea9218d415\n",
            "To: /content/sales_transactions.parquet\n",
            "100%|██████████| 139M/139M [00:01<00:00, 75.7MB/s]\n",
            "Downloading...\n",
            "From: https://drive.google.com/uc?id=1gI0SQI1cYXLtbttcu6tNqLZjk8bXAUod\n",
            "To: /content/products_catalog.parquet\n",
            "100%|██████████| 405k/405k [00:00<00:00, 96.4MB/s]\n",
            "Downloading...\n",
            "From: https://drive.google.com/uc?id=1K4KrT8InCbHs2EDOb6SDaVhJ00ShcRq0\n",
            "To: /content/sales_points.parquet\n",
            "100%|██████████| 290k/290k [00:00<00:00, 91.1MB/s]\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "## 1.2) Transformation"
      ],
      "metadata": {
        "id": "SlxQEgT7I-_8"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "Let's also merge the three resulting dataframes to once!"
      ],
      "metadata": {
        "id": "ci9Ch6IH98bU"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "_65qHS8XJIIf"
      },
      "outputs": [],
      "source": [
        "# Merge the first dataframe with the second\n",
        "df_pdv = df1.merge(\n",
        "    df2,\n",
        "    left_on=\"internal_product_id\",\n",
        "    right_on=\"produto\",\n",
        "    how=\"left\"\n",
        ")\n",
        "# Merge the dataframe above with the third\n",
        "df_pdv = df_pdv.merge(\n",
        "    df3,\n",
        "    left_on=\"internal_store_id\",\n",
        "    right_on=\"pdv\",\n",
        "    how=\"left\"\n",
        ")"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Displaying the main dataframe first and last five columns, and it final shape (6560698 rows × 23 columns)."
      ],
      "metadata": {
        "id": "bD9yW4jW-P53"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 895
        },
        "id": "KOPi51ld5RW5",
        "outputId": "4a1539fd-f672-4f06-8df3-d134e29a1cf3"
      },
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "           internal_store_id  internal_product_id distributor_id  \\\n",
              "0        7384367747233276219   328903483604537190              9   \n",
              "1        3536908514005606262  5418855670645487653              5   \n",
              "2        3138231730993449825  1087005562675741887              6   \n",
              "3        3681167389484217654  1401422983880045188              5   \n",
              "4        7762413312337359369  6614994347738381720              4   \n",
              "...                      ...                  ...            ...   \n",
              "6560693  1439579822593789678  2523145330235258825              4   \n",
              "6560694  2357589266242432199  3148628429396585683              4   \n",
              "6560695  7245187752757348055  6668439675743950745              4   \n",
              "6560696  8952609383990245450  3894706280449257667              5   \n",
              "6560697   815150310325179165  3479075165556992938              4   \n",
              "\n",
              "        transaction_date reference_date  quantity  gross_value    net_value  \\\n",
              "0             2022-07-13     2022-07-01       1.0    38.125000    37.890625   \n",
              "1             2022-03-21     2022-03-01       6.0   107.250000   106.440002   \n",
              "2             2022-09-06     2022-09-01       3.0    56.625000    56.220001   \n",
              "3             2022-09-11     2022-09-01     129.0  1037.160023  1037.160023   \n",
              "4             2022-02-18     2022-02-01       1.0    26.230000    23.950241   \n",
              "...                  ...            ...       ...          ...          ...   \n",
              "6560693       2022-12-06     2022-12-01       3.0    63.000000    61.379761   \n",
              "6560694       2022-05-20     2022-05-01       1.0    12.300000    12.300000   \n",
              "6560695       2022-08-17     2022-08-01       1.0    33.849998    31.570240   \n",
              "6560696       2022-02-03     2022-02-01       4.0    74.556000    73.655998   \n",
              "6560697       2022-11-30     2022-11-01       2.0    56.060001    51.500484   \n",
              "\n",
              "         gross_profit    discount     taxes              produto  \\\n",
              "0           10.042625    3.950000  0.234375   328903483604537190   \n",
              "1           24.732002   17.100000  0.810000  5418855670645487653   \n",
              "2           14.124002    5.250000  0.405000  1087005562675741887   \n",
              "3          156.348026  479.880006  0.000000  1401422983880045188   \n",
              "4            6.550241    0.000000  2.279758  6614994347738381720   \n",
              "...               ...         ...       ...                  ...   \n",
              "6560693     20.879761    0.000000  1.620240  2523145330235258825   \n",
              "6560694      3.650000    2.800000  0.000000  3148628429396585683   \n",
              "6560695     10.191240    0.000000  2.279758  6668439675743950745   \n",
              "6560696     17.991999   15.600000  0.900000  3894706280449257667   \n",
              "6560697     14.612485    0.000000  4.559516  3479075165556992938   \n",
              "\n",
              "                 categoria                                      descricao  \\\n",
              "0                  Package               BUD LIGHT CHELADA FUEGO 15/25 CN   \n",
              "1                  Package                        MICHELOB ULTRA 18/12 CN   \n",
              "2                  Package                        BUD LIGHT LIME 18/12 CN   \n",
              "3        Distilled Spirits                99 BUTTERSCOTCH 12/10/50ML 99PF   \n",
              "4                  Package       NB VOODOO RANGER IMPERIAL IPA 15/19.2 CN   \n",
              "...                    ...                                            ...   \n",
              "6560693  Distilled Spirits                 DRY COUNTY OLD FASHIONED 750ML   \n",
              "6560694        Non-Alcohol  SPARK ICE + CAFFEINE BLACK RASPBERRY 12/16 CN   \n",
              "6560695            Package               SPATEN PREMIUM LAGER 4/6/12 LNNR   \n",
              "6560696            Package                           BUSCH LIGHT 30/12 CN   \n",
              "6560697            Package      GOOSE ISLAND TROPICAL BEER HUG 15/19.2 CN   \n",
              "\n",
              "                            tipos         label         subcategoria  \\\n",
              "0                         Package          Core            Specialty   \n",
              "1                         Package          Core                Lager   \n",
              "2                         Package          Core                Lager   \n",
              "3               Allocated Spirits          None  Liqueurs & Cordials   \n",
              "4                         Package          Core                  IPA   \n",
              "...                           ...           ...                  ...   \n",
              "6560693  Distilled Spirits-Domest  Discontinued       Ready-to-Drink   \n",
              "6560694               Non Alcohol          Core                Water   \n",
              "6560695                   Package          None                Lager   \n",
              "6560696                   Package          Core                Lager   \n",
              "6560697                   Package          Core                  IPA   \n",
              "\n",
              "                                            marca             fabricante  \\\n",
              "0                         Bud Light Chelada Fuego  AB Anheuser Busch Inc   \n",
              "1                                  Michelob Ultra  AB Anheuser Busch Inc   \n",
              "2                                  Bud Light Lime  AB Anheuser Busch Inc   \n",
              "3                                 99 Butterscotch        Sazerac Spirits   \n",
              "4          New Belgium Voodoo Ranger Imperial IPA         NB New Belgium   \n",
              "...                                           ...                    ...   \n",
              "6560693                  Dry County Old Fashioned     Dry County Spirits   \n",
              "6560694  Sparkling Ice + Caffeine Black Raspberry           Talking Rain   \n",
              "6560695                      Spaten Premium Lager  AB Anheuser Busch Inc   \n",
              "6560696                               Busch Light  AB Anheuser Busch Inc   \n",
              "6560697            Goose Island Tropical Beer Hug  AB Anheuser Busch Inc   \n",
              "\n",
              "                         pdv      premise   categoria_pdv  zipcode  \n",
              "0        7384367747233276219  Off Premise  Package/Liquor  80905.0  \n",
              "1        3536908514005606262  Off Premise  Package/Liquor  80239.0  \n",
              "2        3138231730993449825  Off Premise  Package/Liquor  80634.0  \n",
              "3        3681167389484217654  Off Premise  Package/Liquor  80226.0  \n",
              "4        7762413312337359369  Off Premise     Convenience  30096.0  \n",
              "...                      ...          ...             ...      ...  \n",
              "6560693  1439579822593789678  Off Premise  Package/Liquor  30071.0  \n",
              "6560694  2357589266242432199  Off Premise         Grocery  30076.0  \n",
              "6560695  7245187752757348055  Off Premise         Grocery  30121.0  \n",
              "6560696  8952609383990245450  Off Premise         Grocery  80602.0  \n",
              "6560697   815150310325179165  Off Premise     Convenience  30058.0  \n",
              "\n",
              "[6560698 rows x 23 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-42b87808-eebf-43d5-a94a-aba3fef1e46e\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>internal_store_id</th>\n",
              "      <th>internal_product_id</th>\n",
              "      <th>distributor_id</th>\n",
              "      <th>transaction_date</th>\n",
              "      <th>reference_date</th>\n",
              "      <th>quantity</th>\n",
              "      <th>gross_value</th>\n",
              "      <th>net_value</th>\n",
              "      <th>gross_profit</th>\n",
              "      <th>discount</th>\n",
              "      <th>taxes</th>\n",
              "      <th>produto</th>\n",
              "      <th>categoria</th>\n",
              "      <th>descricao</th>\n",
              "      <th>tipos</th>\n",
              "      <th>label</th>\n",
              "      <th>subcategoria</th>\n",
              "      <th>marca</th>\n",
              "      <th>fabricante</th>\n",
              "      <th>pdv</th>\n",
              "      <th>premise</th>\n",
              "      <th>categoria_pdv</th>\n",
              "      <th>zipcode</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>7384367747233276219</td>\n",
              "      <td>328903483604537190</td>\n",
              "      <td>9</td>\n",
              "      <td>2022-07-13</td>\n",
              "      <td>2022-07-01</td>\n",
              "      <td>1.0</td>\n",
              "      <td>38.125000</td>\n",
              "      <td>37.890625</td>\n",
              "      <td>10.042625</td>\n",
              "      <td>3.950000</td>\n",
              "      <td>0.234375</td>\n",
              "      <td>328903483604537190</td>\n",
              "      <td>Package</td>\n",
              "      <td>BUD LIGHT CHELADA FUEGO 15/25 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>Specialty</td>\n",
              "      <td>Bud Light Chelada Fuego</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "      <td>7384367747233276219</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>80905.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>3536908514005606262</td>\n",
              "      <td>5418855670645487653</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-03-21</td>\n",
              "      <td>2022-03-01</td>\n",
              "      <td>6.0</td>\n",
              "      <td>107.250000</td>\n",
              "      <td>106.440002</td>\n",
              "      <td>24.732002</td>\n",
              "      <td>17.100000</td>\n",
              "      <td>0.810000</td>\n",
              "      <td>5418855670645487653</td>\n",
              "      <td>Package</td>\n",
              "      <td>MICHELOB ULTRA 18/12 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>Lager</td>\n",
              "      <td>Michelob Ultra</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "      <td>3536908514005606262</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>80239.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>3138231730993449825</td>\n",
              "      <td>1087005562675741887</td>\n",
              "      <td>6</td>\n",
              "      <td>2022-09-06</td>\n",
              "      <td>2022-09-01</td>\n",
              "      <td>3.0</td>\n",
              "      <td>56.625000</td>\n",
              "      <td>56.220001</td>\n",
              "      <td>14.124002</td>\n",
              "      <td>5.250000</td>\n",
              "      <td>0.405000</td>\n",
              "      <td>1087005562675741887</td>\n",
              "      <td>Package</td>\n",
              "      <td>BUD LIGHT LIME 18/12 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>Lager</td>\n",
              "      <td>Bud Light Lime</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "      <td>3138231730993449825</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>80634.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>3681167389484217654</td>\n",
              "      <td>1401422983880045188</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-09-11</td>\n",
              "      <td>2022-09-01</td>\n",
              "      <td>129.0</td>\n",
              "      <td>1037.160023</td>\n",
              "      <td>1037.160023</td>\n",
              "      <td>156.348026</td>\n",
              "      <td>479.880006</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>1401422983880045188</td>\n",
              "      <td>Distilled Spirits</td>\n",
              "      <td>99 BUTTERSCOTCH 12/10/50ML 99PF</td>\n",
              "      <td>Allocated Spirits</td>\n",
              "      <td>None</td>\n",
              "      <td>Liqueurs &amp; Cordials</td>\n",
              "      <td>99 Butterscotch</td>\n",
              "      <td>Sazerac Spirits</td>\n",
              "      <td>3681167389484217654</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>80226.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>7762413312337359369</td>\n",
              "      <td>6614994347738381720</td>\n",
              "      <td>4</td>\n",
              "      <td>2022-02-18</td>\n",
              "      <td>2022-02-01</td>\n",
              "      <td>1.0</td>\n",
              "      <td>26.230000</td>\n",
              "      <td>23.950241</td>\n",
              "      <td>6.550241</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>2.279758</td>\n",
              "      <td>6614994347738381720</td>\n",
              "      <td>Package</td>\n",
              "      <td>NB VOODOO RANGER IMPERIAL IPA 15/19.2 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>IPA</td>\n",
              "      <td>New Belgium Voodoo Ranger Imperial IPA</td>\n",
              "      <td>NB New Belgium</td>\n",
              "      <td>7762413312337359369</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Convenience</td>\n",
              "      <td>30096.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560693</th>\n",
              "      <td>1439579822593789678</td>\n",
              "      <td>2523145330235258825</td>\n",
              "      <td>4</td>\n",
              "      <td>2022-12-06</td>\n",
              "      <td>2022-12-01</td>\n",
              "      <td>3.0</td>\n",
              "      <td>63.000000</td>\n",
              "      <td>61.379761</td>\n",
              "      <td>20.879761</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>1.620240</td>\n",
              "      <td>2523145330235258825</td>\n",
              "      <td>Distilled Spirits</td>\n",
              "      <td>DRY COUNTY OLD FASHIONED 750ML</td>\n",
              "      <td>Distilled Spirits-Domest</td>\n",
              "      <td>Discontinued</td>\n",
              "      <td>Ready-to-Drink</td>\n",
              "      <td>Dry County Old Fashioned</td>\n",
              "      <td>Dry County Spirits</td>\n",
              "      <td>1439579822593789678</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>30071.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560694</th>\n",
              "      <td>2357589266242432199</td>\n",
              "      <td>3148628429396585683</td>\n",
              "      <td>4</td>\n",
              "      <td>2022-05-20</td>\n",
              "      <td>2022-05-01</td>\n",
              "      <td>1.0</td>\n",
              "      <td>12.300000</td>\n",
              "      <td>12.300000</td>\n",
              "      <td>3.650000</td>\n",
              "      <td>2.800000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>3148628429396585683</td>\n",
              "      <td>Non-Alcohol</td>\n",
              "      <td>SPARK ICE + CAFFEINE BLACK RASPBERRY 12/16 CN</td>\n",
              "      <td>Non Alcohol</td>\n",
              "      <td>Core</td>\n",
              "      <td>Water</td>\n",
              "      <td>Sparkling Ice + Caffeine Black Raspberry</td>\n",
              "      <td>Talking Rain</td>\n",
              "      <td>2357589266242432199</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Grocery</td>\n",
              "      <td>30076.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560695</th>\n",
              "      <td>7245187752757348055</td>\n",
              "      <td>6668439675743950745</td>\n",
              "      <td>4</td>\n",
              "      <td>2022-08-17</td>\n",
              "      <td>2022-08-01</td>\n",
              "      <td>1.0</td>\n",
              "      <td>33.849998</td>\n",
              "      <td>31.570240</td>\n",
              "      <td>10.191240</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>2.279758</td>\n",
              "      <td>6668439675743950745</td>\n",
              "      <td>Package</td>\n",
              "      <td>SPATEN PREMIUM LAGER 4/6/12 LNNR</td>\n",
              "      <td>Package</td>\n",
              "      <td>None</td>\n",
              "      <td>Lager</td>\n",
              "      <td>Spaten Premium Lager</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "      <td>7245187752757348055</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Grocery</td>\n",
              "      <td>30121.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560696</th>\n",
              "      <td>8952609383990245450</td>\n",
              "      <td>3894706280449257667</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-02-03</td>\n",
              "      <td>2022-02-01</td>\n",
              "      <td>4.0</td>\n",
              "      <td>74.556000</td>\n",
              "      <td>73.655998</td>\n",
              "      <td>17.991999</td>\n",
              "      <td>15.600000</td>\n",
              "      <td>0.900000</td>\n",
              "      <td>3894706280449257667</td>\n",
              "      <td>Package</td>\n",
              "      <td>BUSCH LIGHT 30/12 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>Lager</td>\n",
              "      <td>Busch Light</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "      <td>8952609383990245450</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Grocery</td>\n",
              "      <td>80602.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560697</th>\n",
              "      <td>815150310325179165</td>\n",
              "      <td>3479075165556992938</td>\n",
              "      <td>4</td>\n",
              "      <td>2022-11-30</td>\n",
              "      <td>2022-11-01</td>\n",
              "      <td>2.0</td>\n",
              "      <td>56.060001</td>\n",
              "      <td>51.500484</td>\n",
              "      <td>14.612485</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>4.559516</td>\n",
              "      <td>3479075165556992938</td>\n",
              "      <td>Package</td>\n",
              "      <td>GOOSE ISLAND TROPICAL BEER HUG 15/19.2 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>IPA</td>\n",
              "      <td>Goose Island Tropical Beer Hug</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "      <td>815150310325179165</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Convenience</td>\n",
              "      <td>30058.0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>6560698 rows × 23 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-42b87808-eebf-43d5-a94a-aba3fef1e46e')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-42b87808-eebf-43d5-a94a-aba3fef1e46e button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-42b87808-eebf-43d5-a94a-aba3fef1e46e');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "  <div id=\"id_a7544927-e76b-47cc-8c5b-cecefa7f626b\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('df_pdv')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_a7544927-e76b-47cc-8c5b-cecefa7f626b button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('df_pdv');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "df_pdv"
            }
          },
          "metadata": {}
        }
      ],
      "source": [
        "# Display the dataframe data showing all the columns mandatorily\n",
        "with pd.option_context('display.max_columns', None):\n",
        "    display(df_pdv)\n",
        "# Gets the table shape\n",
        "sp = df_pdv.shape"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "There is some column names in portuguese and less explanatory, let's translate to english to unify the language reading."
      ],
      "metadata": {
        "id": "EjL17-5rSenO"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Dictionary with the old and new column names to be replaced\n",
        "col_map = {\n",
        "    \"produto\": \"product_id\",\n",
        "    \"categoria\": \"category\",\n",
        "    \"descricao\": \"description\",\n",
        "    \"tipos\": \"type\",\n",
        "    \"label\": \"label\",\n",
        "    \"subcategoria\": \"subcategory\",\n",
        "    \"marca\": \"brand\",\n",
        "    \"fabricante\": \"manufacturer\",\n",
        "    \"pdv\": \"pdv_id\",\n",
        "    \"categoria_pdv\": \"pdv_category\"\n",
        "}\n",
        "# Rename all the previous dictionary columns\n",
        "df_pdv = df_pdv.rename(columns=col_map)\n",
        "# show all the updated columns from the dataframe\n",
        "print(df_pdv.columns)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "hysTsbXMP3k1",
        "outputId": "dc313323-c65e-4c55-ed2d-893faa985683"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Index(['internal_store_id', 'internal_product_id', 'distributor_id',\n",
            "       'transaction_date', 'reference_date', 'quantity', 'gross_value',\n",
            "       'net_value', 'gross_profit', 'discount', 'taxes', 'product_id',\n",
            "       'category', 'description', 'type', 'label', 'subcategory', 'brand',\n",
            "       'manufacturer', 'pdv_id', 'premise', 'pdv_category', 'zipcode'],\n",
            "      dtype='object')\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Doing a curated study of the raw dataset that was provided and the generated dataframe, we created this data dictionary containing the following main columns for the three distinct tables:\n",
        "<br>\n",
        "<br>\n",
        "sales_transactions Table\n",
        "\n",
        "    internal_store_id: Unique identifier of the store (Point of Sale) where the transaction occurred. Connects to pdv in the pontos_venda.csv table as a foreign key.\n",
        "\n",
        "    internal_product_id: Unique identifier of the product sold. Connects to produto in the produtos_catalogo.csv table as a foreign key.\n",
        "\n",
        "    distributor_id: Identifier of the distributor associated with the sale.\n",
        "\n",
        "    transaction_date: The exact date the transaction was recorded (day/month/year).\n",
        "\n",
        "    reference_date: A reference date, used for grouping by the first day of the transaction month based on transaction_date.\n",
        "\n",
        "    quantity: The quantity of product units sold in the transaction.\n",
        "\n",
        "    unit_price: The price of a single unit of the product. This value is derived by dividing the gross_value by the quantity (gross_value / quantity). It represents the list price of the product before any specific transaction discounts or taxes are applied.\n",
        "\n",
        "    gross_value: The total gross value of the transaction (unit price * quantity), before taxes and discounts.\n",
        "\n",
        "    net_value: The net value of the transaction. The gross value minus discounts and/or taxes (gross_value - discount - taxes).\n",
        "\n",
        "    gross_profit: The gross profit obtained in the transaction (usually, net value - product cost).\n",
        "\n",
        "    discount: The total discount value applied to the transaction.\n",
        "\n",
        "    taxes: The value of taxes applicable to the transaction.\n",
        "\n",
        "products_catalog Table\n",
        "\n",
        "    product_id: Unique identifier of the product (Primary Key).\n",
        "\n",
        "    category: The main category of the product (e.g., \"Distilled Spirits\", \"Wine\", \"Non-Alcohol\").\n",
        "\n",
        "    description: The name or textual description of the product (e.g., \"JOSEPH CARTRON CAFÉ LIQUEUR\").\n",
        "\n",
        "    type: An additional type or classification (e.g., \"Distilled Spirits\", \"Draft\").\n",
        "\n",
        "    label: A marketing or inventory classification tag or label (e.g., \"Core\", \"Specialty\", \"Private Label\").\n",
        "\n",
        "    subcategory: A more specific subdivision of the category (e.g., \"Liqueurs & Cordials\", \"Scotch Whisky\").\n",
        "\n",
        "    brand: The commercial brand of the product.\n",
        "\n",
        "    manufacturer: The name of the manufacturer or supplier of the product.\n",
        "\n",
        "sales_points Table\n",
        "\n",
        "    pdv: Unique identifier of the Point of Sale (POS).\n",
        "\n",
        "    premise: The type of establishment, indicating the consumption model:\n",
        "\n",
        "        On Premise: On-site consumption (e.g., restaurants, bars).\n",
        "\n",
        "        Off Premise: Off-site consumption (e.g., supermarkets, convenience stores, liquor stores).\n",
        "\n",
        "    categoria_pdv: The specific category of the point of sale (e.g., \"Mexican Rest\", \"Convenience\", \"Package/Liquor\", \"Hotel/Motel\").\n",
        "\n",
        "    zipcode: The ZIP Code (Postal Code) of the point of sale's location."
      ],
      "metadata": {
        "id": "wBZQUubeCFUE"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "From there, let's start our data cleaning. For that, we must see what are the missing columns and how much are missing from each one."
      ],
      "metadata": {
        "id": "2c7dv8A8ImWS"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 843
        },
        "id": "ah7v79kW5T2t",
        "outputId": "8589972f-221f-46a2-8d55-621f2f95c816"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "internal_store_id           0\n",
              "internal_product_id         0\n",
              "distributor_id              0\n",
              "transaction_date            0\n",
              "reference_date              0\n",
              "quantity                    0\n",
              "gross_value                 0\n",
              "net_value                   0\n",
              "gross_profit                0\n",
              "discount                    0\n",
              "taxes                       0\n",
              "product_id                  0\n",
              "category                    0\n",
              "description                 0\n",
              "type                        0\n",
              "label                  526953\n",
              "subcategory             10312\n",
              "brand                       0\n",
              "manufacturer                0\n",
              "pdv_id                  45582\n",
              "premise                 45582\n",
              "pdv_category            45582\n",
              "zipcode                 45582\n",
              "dtype: int64"
            ],
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>0</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>internal_store_id</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>internal_product_id</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>distributor_id</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>transaction_date</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>reference_date</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>quantity</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>gross_value</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>net_value</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>gross_profit</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>discount</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>taxes</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>product_id</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>category</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>description</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>type</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>label</th>\n",
              "      <td>526953</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>subcategory</th>\n",
              "      <td>10312</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>brand</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>manufacturer</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>pdv_id</th>\n",
              "      <td>45582</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>premise</th>\n",
              "      <td>45582</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>pdv_category</th>\n",
              "      <td>45582</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>zipcode</th>\n",
              "      <td>45582</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div><br><label><b>dtype:</b> int64</label>"
            ]
          },
          "metadata": {},
          "execution_count": 6
        }
      ],
      "source": [
        "# Show how much null values are present on each column\n",
        "df_pdv.isna().sum()"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "OUCrK1neNLGz"
      },
      "source": [
        "For this case we'are going to do group inferences from statistics, Hot Deck data imputation in specific one. As recommended rule for doing so, the replacing column must not have less unique values than the missing column to be replaced but should be close and preferably form the same original table. So we will print all number or unique values and if is nullable of each column to use as reference."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "_SJXR6hn1ADS",
        "outputId": "e8f5ede4-1b80-4eb1-c687-1add45acc4fe"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Unique Values:\n",
            "product_id:    7092\n",
            "category:         7\n",
            "description:   7092\n",
            "type:            22\n",
            "label:           14 / Null\n",
            "subcategory:     42 / Null\n",
            "brand:         4221\n",
            "manufacturer:   343\n"
          ]
        }
      ],
      "source": [
        "# Columns list from the dataset where are missing values, df2!\n",
        "col = [\"product_id\", \"category\", \"description\", \"type\", \"label\", \"subcategory\", \"brand\", \"manufacturer\"]\n",
        "\n",
        "# Print all the amount of unique values each column above have, and show which contain null data, \"label\" and \"subcategory\"\n",
        "print(\"Unique Values:\")\n",
        "for i in col:\n",
        "  if df_pdv[i].isna().any():\n",
        "    print(f\"{i+':':<13} {df_pdv[i].nunique():>5} / Null\")\n",
        "  else:\n",
        "    print(f\"{i+':':<13} {df_pdv[i].nunique():>5}\")"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Well, to start replacing \"label\" null values, the best statistical column candidate for that is \"type\", since it's the column reference who left the least missing values, just two rows."
      ],
      "metadata": {
        "id": "jE4WjffvOc1c"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "gb_cols = \"type\" # Column reference from where the data will be grouped by to be replaced\n",
        "na_cols = \"label\" # Missing column\n",
        "# Sort dataframe column values by \"type\" and get a copy of it\n",
        "sample_label = df_pdv.sort_values(by=gb_cols).copy()\n",
        "# Give a forward fill grouped by \"type\" on \"label\" column\n",
        "sample_label[na_cols] = sample_label.groupby(gb_cols)[na_cols].ffill()\n",
        "# Give a backward fill grouped by \"type\" on \"label\" column\n",
        "sample_label[na_cols] = sample_label.groupby(gb_cols)[na_cols].bfill()\n",
        "# Get the number of remaining missing values after treatiing the \"label\" column\n",
        "na_val = sample_label[na_cols].isna().sum()\n",
        "print(f\"Remaining nulls: {na_val}\") # Print remaining nulls\n",
        "# Display the dataframe values where there's no \"label\" column value\n",
        "display(sample_label[sample_label[\"label\"].isna()])"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 283
        },
        "id": "tP5BDk_nAMAU",
        "outputId": "6b9789b3-125c-454a-ddf5-42ead6ee68ca"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Remaining nulls: 2\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "           internal_store_id internal_product_id distributor_id  \\\n",
              "2669148  8646258721275401690  741492884380856720              8   \n",
              "5884328  7015121682835447825  741492884380856720              8   \n",
              "\n",
              "        transaction_date reference_date  quantity  gross_value  net_value  \\\n",
              "2669148       2022-08-14     2022-08-01       1.0         32.5      32.32   \n",
              "5884328       2022-01-20     2022-01-01       0.0          0.0       0.00   \n",
              "\n",
              "         gross_profit  discount  ...                       description  \\\n",
              "2669148     10.552999       0.0  ...  GOOSE INDIA PALE ALE 4/6/12 LN 3   \n",
              "5884328    -10.779000       0.0  ...  GOOSE INDIA PALE ALE 4/6/12 LN 3   \n",
              "\n",
              "            type label subcategory             brand           manufacturer  \\\n",
              "2669148  Pkg 3.2   NaN         IPA  Goose Island IPA  AB Anheuser Busch Inc   \n",
              "5884328  Pkg 3.2   NaN         IPA  Goose Island IPA  AB Anheuser Busch Inc   \n",
              "\n",
              "                      pdv_id      premise    pdv_category  zipcode  \n",
              "2669148  8646258721275401690  Off Premise  Package/Liquor  81007.0  \n",
              "5884328                  NaN          NaN             NaN      NaN  \n",
              "\n",
              "[2 rows x 23 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-83d13482-94c8-4020-ab8f-63ea27db7fe7\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>internal_store_id</th>\n",
              "      <th>internal_product_id</th>\n",
              "      <th>distributor_id</th>\n",
              "      <th>transaction_date</th>\n",
              "      <th>reference_date</th>\n",
              "      <th>quantity</th>\n",
              "      <th>gross_value</th>\n",
              "      <th>net_value</th>\n",
              "      <th>gross_profit</th>\n",
              "      <th>discount</th>\n",
              "      <th>...</th>\n",
              "      <th>description</th>\n",
              "      <th>type</th>\n",
              "      <th>label</th>\n",
              "      <th>subcategory</th>\n",
              "      <th>brand</th>\n",
              "      <th>manufacturer</th>\n",
              "      <th>pdv_id</th>\n",
              "      <th>premise</th>\n",
              "      <th>pdv_category</th>\n",
              "      <th>zipcode</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>2669148</th>\n",
              "      <td>8646258721275401690</td>\n",
              "      <td>741492884380856720</td>\n",
              "      <td>8</td>\n",
              "      <td>2022-08-14</td>\n",
              "      <td>2022-08-01</td>\n",
              "      <td>1.0</td>\n",
              "      <td>32.5</td>\n",
              "      <td>32.32</td>\n",
              "      <td>10.552999</td>\n",
              "      <td>0.0</td>\n",
              "      <td>...</td>\n",
              "      <td>GOOSE INDIA PALE ALE 4/6/12 LN 3</td>\n",
              "      <td>Pkg 3.2</td>\n",
              "      <td>NaN</td>\n",
              "      <td>IPA</td>\n",
              "      <td>Goose Island IPA</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "      <td>8646258721275401690</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>81007.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>5884328</th>\n",
              "      <td>7015121682835447825</td>\n",
              "      <td>741492884380856720</td>\n",
              "      <td>8</td>\n",
              "      <td>2022-01-20</td>\n",
              "      <td>2022-01-01</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.00</td>\n",
              "      <td>-10.779000</td>\n",
              "      <td>0.0</td>\n",
              "      <td>...</td>\n",
              "      <td>GOOSE INDIA PALE ALE 4/6/12 LN 3</td>\n",
              "      <td>Pkg 3.2</td>\n",
              "      <td>NaN</td>\n",
              "      <td>IPA</td>\n",
              "      <td>Goose Island IPA</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>2 rows × 23 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-83d13482-94c8-4020-ab8f-63ea27db7fe7')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-83d13482-94c8-4020-ab8f-63ea27db7fe7 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-83d13482-94c8-4020-ab8f-63ea27db7fe7');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe"
            }
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Investigating the both \"label\" missing values, We can infer that it correct value to be replaced is \"Core\", since on \"type\" column, \"Pkg 3.2\" is package abreviation, 3.2 is a reference to the dimensions of it and there are other rows with \"Package\" and \"core\" on \"type\" and \"label\" respective columns."
      ],
      "metadata": {
        "id": "VE6-DnRKFGGW"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "qHIHz4c_KHmT",
        "outputId": "0501cdb4-d26d-4a81-d93f-ba1e0bafb580"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Remaining nulls: 0\n"
          ]
        }
      ],
      "source": [
        "# Replace two missing values by \"Core\" value\n",
        "df_pdv[\"label\"] = sample_label[\"label\"].fillna(\"Core\")\n",
        "# Confirm if ther is any missing value\n",
        "print(f\"Remaining nulls: {df_pdv[\"label\"].isna().sum()}\")"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "On the other hand, the best candidate to replace \"subcatecogry\" missing values is \"manufacturer\", leaving only 430 null rows."
      ],
      "metadata": {
        "id": "4ZNlipc_OKK7"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "gb_cols = \"manufacturer\" # Column reference from where the data will be grouped by to be replaced\n",
        "na_cols = \"subcategory\" # Missing column\n",
        "# Sort dataframe column values by \"manufacturer\" and get a copy of it\n",
        "sample_subc = df_pdv.sort_values(by=gb_cols).copy()\n",
        "# Give a forward fill grouped by \"manufacturer\" on \"label\" column\n",
        "sample_subc[na_cols] = sample_subc.groupby(gb_cols)[na_cols].ffill()\n",
        "# Give a backward fill grouped by \"manufacturer\" on \"subcategory\" column\n",
        "sample_subc[na_cols] = sample_subc.groupby(gb_cols)[na_cols].bfill()\n",
        "# Get the number of remaining missing values after treatiing the \"subcategory\" column\n",
        "na_val = sample_subc[na_cols].isna().sum()\n",
        "print(f\"Remaining nulls: {na_val}\") # Print remaining nulls\n",
        "# Display the dataframe values where there's no \"subcategory\" column value\n",
        "display(sample_subc[sample_subc[\"subcategory\"].isna()])"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 878
        },
        "id": "gMwygY-CQmo3",
        "outputId": "3fdc642b-5e89-4fb0-da98-073f6a539f47"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Remaining nulls: 430\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "           internal_store_id  internal_product_id distributor_id  \\\n",
              "2576757  4878996146500706960  6673449460752341999              5   \n",
              "3785833   976343201091903952  6673449460752341999              5   \n",
              "4468180   526709827379630898  6673449460752341999              5   \n",
              "3479306  2916916554204552388  6673449460752341999              7   \n",
              "5441235  1815573037674402746  6673449460752341999              5   \n",
              "...                      ...                  ...            ...   \n",
              "6012012   557003579463267820  6673449460752341999              5   \n",
              "4867520  2013318595312594455  1219077194660596578              7   \n",
              "5942284  3892473169314085043  6673449460752341999              5   \n",
              "3995527  2389148903835685831  1219077194660596578              5   \n",
              "2370883  1826133453691379178  6673449460752341999              5   \n",
              "\n",
              "        transaction_date reference_date  quantity  gross_value   net_value  \\\n",
              "2576757       2022-10-06     2022-10-01       2.0   141.539993  141.539993   \n",
              "3785833       2022-10-06     2022-10-01       2.0   141.539993  141.539993   \n",
              "4468180       2022-10-06     2022-10-01       2.0   141.539993  141.539993   \n",
              "3479306       2022-10-20     2022-10-01       2.0   141.539993  141.539993   \n",
              "5441235       2022-10-06     2022-10-01       2.0   141.539993  141.539993   \n",
              "...                  ...            ...       ...          ...         ...   \n",
              "6012012       2022-10-06     2022-10-01       2.0   141.539993  141.539993   \n",
              "4867520       2022-10-20     2022-10-01       2.0   141.539993  141.539993   \n",
              "5942284       2022-11-15     2022-11-01       1.0    67.099998   67.099998   \n",
              "3995527       2022-10-06     2022-10-01       2.0   141.539993  141.539993   \n",
              "2370883       2022-12-09     2022-12-01       1.0    70.769997   70.769997   \n",
              "\n",
              "         gross_profit  discount  ...                         description  \\\n",
              "2576757     26.459993      3.12  ...          VLN KING CIGARETTES 10/20C   \n",
              "3785833     26.459993      3.12  ...          VLN KING CIGARETTES 10/20C   \n",
              "4468180     26.459993      3.12  ...          VLN KING CIGARETTES 10/20C   \n",
              "3479306     26.459993      3.12  ...          VLN KING CIGARETTES 10/20C   \n",
              "5441235     26.459993      3.12  ...          VLN KING CIGARETTES 10/20C   \n",
              "...               ...       ...  ...                                 ...   \n",
              "6012012     26.459993      3.12  ...          VLN KING CIGARETTES 10/20C   \n",
              "4867520     26.459993      3.12  ...  VLN MENTHOL KING CIGARETTES 10/20C   \n",
              "5942284      9.559999      0.00  ...          VLN KING CIGARETTES 10/20C   \n",
              "3995527     26.459993      3.12  ...  VLN MENTHOL KING CIGARETTES 10/20C   \n",
              "2370883     12.229997      1.56  ...          VLN KING CIGARETTES 10/20C   \n",
              "\n",
              "            type label subcategory                        brand  \\\n",
              "2576757  Tobacco  Core         NaN          VLN King Cigarettes   \n",
              "3785833  Tobacco  Core         NaN          VLN King Cigarettes   \n",
              "4468180  Tobacco  Core         NaN          VLN King Cigarettes   \n",
              "3479306  Tobacco  Core         NaN          VLN King Cigarettes   \n",
              "5441235  Tobacco  Core         NaN          VLN King Cigarettes   \n",
              "...          ...   ...         ...                          ...   \n",
              "6012012  Tobacco  Core         NaN          VLN King Cigarettes   \n",
              "4867520  Tobacco  Core         NaN  VLN Menthol King Cigarettes   \n",
              "5942284  Tobacco  Core         NaN          VLN King Cigarettes   \n",
              "3995527  Tobacco  Core         NaN  VLN Menthol King Cigarettes   \n",
              "2370883  Tobacco  Core         NaN          VLN King Cigarettes   \n",
              "\n",
              "           manufacturer               pdv_id      premise    pdv_category  \\\n",
              "2576757  NASCO Products  4878996146500706960  Off Premise     Convenience   \n",
              "3785833  NASCO Products   976343201091903952  Off Premise     Convenience   \n",
              "4468180  NASCO Products   526709827379630898  Off Premise     Convenience   \n",
              "3479306  NASCO Products  2916916554204552388  Off Premise     Convenience   \n",
              "5441235  NASCO Products  1815573037674402746  Off Premise     Convenience   \n",
              "...                 ...                  ...          ...             ...   \n",
              "6012012  NASCO Products   557003579463267820  Off Premise     Convenience   \n",
              "4867520  NASCO Products  2013318595312594455  Off Premise     Convenience   \n",
              "5942284  NASCO Products  3892473169314085043  Off Premise  Package/Liquor   \n",
              "3995527  NASCO Products  2389148903835685831  Off Premise     Convenience   \n",
              "2370883  NASCO Products  1826133453691379178  Off Premise     Convenience   \n",
              "\n",
              "         zipcode  \n",
              "2576757  80221.0  \n",
              "3785833  80014.0  \n",
              "4468180  80011.0  \n",
              "3479306  80123.0  \n",
              "5441235  80212.0  \n",
              "...          ...  \n",
              "6012012  80221.0  \n",
              "4867520  80122.0  \n",
              "5942284  80233.0  \n",
              "3995527  80102.0  \n",
              "2370883  80005.0  \n",
              "\n",
              "[430 rows x 23 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-fac64823-65c8-4b49-892b-720ff4638929\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>internal_store_id</th>\n",
              "      <th>internal_product_id</th>\n",
              "      <th>distributor_id</th>\n",
              "      <th>transaction_date</th>\n",
              "      <th>reference_date</th>\n",
              "      <th>quantity</th>\n",
              "      <th>gross_value</th>\n",
              "      <th>net_value</th>\n",
              "      <th>gross_profit</th>\n",
              "      <th>discount</th>\n",
              "      <th>...</th>\n",
              "      <th>description</th>\n",
              "      <th>type</th>\n",
              "      <th>label</th>\n",
              "      <th>subcategory</th>\n",
              "      <th>brand</th>\n",
              "      <th>manufacturer</th>\n",
              "      <th>pdv_id</th>\n",
              "      <th>premise</th>\n",
              "      <th>pdv_category</th>\n",
              "      <th>zipcode</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>2576757</th>\n",
              "      <td>4878996146500706960</td>\n",
              "      <td>6673449460752341999</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-10-06</td>\n",
              "      <td>2022-10-01</td>\n",
              "      <td>2.0</td>\n",
              "      <td>141.539993</td>\n",
              "      <td>141.539993</td>\n",
              "      <td>26.459993</td>\n",
              "      <td>3.12</td>\n",
              "      <td>...</td>\n",
              "      <td>VLN KING CIGARETTES 10/20C</td>\n",
              "      <td>Tobacco</td>\n",
              "      <td>Core</td>\n",
              "      <td>NaN</td>\n",
              "      <td>VLN King Cigarettes</td>\n",
              "      <td>NASCO Products</td>\n",
              "      <td>4878996146500706960</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Convenience</td>\n",
              "      <td>80221.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3785833</th>\n",
              "      <td>976343201091903952</td>\n",
              "      <td>6673449460752341999</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-10-06</td>\n",
              "      <td>2022-10-01</td>\n",
              "      <td>2.0</td>\n",
              "      <td>141.539993</td>\n",
              "      <td>141.539993</td>\n",
              "      <td>26.459993</td>\n",
              "      <td>3.12</td>\n",
              "      <td>...</td>\n",
              "      <td>VLN KING CIGARETTES 10/20C</td>\n",
              "      <td>Tobacco</td>\n",
              "      <td>Core</td>\n",
              "      <td>NaN</td>\n",
              "      <td>VLN King Cigarettes</td>\n",
              "      <td>NASCO Products</td>\n",
              "      <td>976343201091903952</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Convenience</td>\n",
              "      <td>80014.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4468180</th>\n",
              "      <td>526709827379630898</td>\n",
              "      <td>6673449460752341999</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-10-06</td>\n",
              "      <td>2022-10-01</td>\n",
              "      <td>2.0</td>\n",
              "      <td>141.539993</td>\n",
              "      <td>141.539993</td>\n",
              "      <td>26.459993</td>\n",
              "      <td>3.12</td>\n",
              "      <td>...</td>\n",
              "      <td>VLN KING CIGARETTES 10/20C</td>\n",
              "      <td>Tobacco</td>\n",
              "      <td>Core</td>\n",
              "      <td>NaN</td>\n",
              "      <td>VLN King Cigarettes</td>\n",
              "      <td>NASCO Products</td>\n",
              "      <td>526709827379630898</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Convenience</td>\n",
              "      <td>80011.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3479306</th>\n",
              "      <td>2916916554204552388</td>\n",
              "      <td>6673449460752341999</td>\n",
              "      <td>7</td>\n",
              "      <td>2022-10-20</td>\n",
              "      <td>2022-10-01</td>\n",
              "      <td>2.0</td>\n",
              "      <td>141.539993</td>\n",
              "      <td>141.539993</td>\n",
              "      <td>26.459993</td>\n",
              "      <td>3.12</td>\n",
              "      <td>...</td>\n",
              "      <td>VLN KING CIGARETTES 10/20C</td>\n",
              "      <td>Tobacco</td>\n",
              "      <td>Core</td>\n",
              "      <td>NaN</td>\n",
              "      <td>VLN King Cigarettes</td>\n",
              "      <td>NASCO Products</td>\n",
              "      <td>2916916554204552388</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Convenience</td>\n",
              "      <td>80123.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>5441235</th>\n",
              "      <td>1815573037674402746</td>\n",
              "      <td>6673449460752341999</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-10-06</td>\n",
              "      <td>2022-10-01</td>\n",
              "      <td>2.0</td>\n",
              "      <td>141.539993</td>\n",
              "      <td>141.539993</td>\n",
              "      <td>26.459993</td>\n",
              "      <td>3.12</td>\n",
              "      <td>...</td>\n",
              "      <td>VLN KING CIGARETTES 10/20C</td>\n",
              "      <td>Tobacco</td>\n",
              "      <td>Core</td>\n",
              "      <td>NaN</td>\n",
              "      <td>VLN King Cigarettes</td>\n",
              "      <td>NASCO Products</td>\n",
              "      <td>1815573037674402746</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Convenience</td>\n",
              "      <td>80212.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6012012</th>\n",
              "      <td>557003579463267820</td>\n",
              "      <td>6673449460752341999</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-10-06</td>\n",
              "      <td>2022-10-01</td>\n",
              "      <td>2.0</td>\n",
              "      <td>141.539993</td>\n",
              "      <td>141.539993</td>\n",
              "      <td>26.459993</td>\n",
              "      <td>3.12</td>\n",
              "      <td>...</td>\n",
              "      <td>VLN KING CIGARETTES 10/20C</td>\n",
              "      <td>Tobacco</td>\n",
              "      <td>Core</td>\n",
              "      <td>NaN</td>\n",
              "      <td>VLN King Cigarettes</td>\n",
              "      <td>NASCO Products</td>\n",
              "      <td>557003579463267820</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Convenience</td>\n",
              "      <td>80221.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4867520</th>\n",
              "      <td>2013318595312594455</td>\n",
              "      <td>1219077194660596578</td>\n",
              "      <td>7</td>\n",
              "      <td>2022-10-20</td>\n",
              "      <td>2022-10-01</td>\n",
              "      <td>2.0</td>\n",
              "      <td>141.539993</td>\n",
              "      <td>141.539993</td>\n",
              "      <td>26.459993</td>\n",
              "      <td>3.12</td>\n",
              "      <td>...</td>\n",
              "      <td>VLN MENTHOL KING CIGARETTES 10/20C</td>\n",
              "      <td>Tobacco</td>\n",
              "      <td>Core</td>\n",
              "      <td>NaN</td>\n",
              "      <td>VLN Menthol King Cigarettes</td>\n",
              "      <td>NASCO Products</td>\n",
              "      <td>2013318595312594455</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Convenience</td>\n",
              "      <td>80122.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>5942284</th>\n",
              "      <td>3892473169314085043</td>\n",
              "      <td>6673449460752341999</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-11-15</td>\n",
              "      <td>2022-11-01</td>\n",
              "      <td>1.0</td>\n",
              "      <td>67.099998</td>\n",
              "      <td>67.099998</td>\n",
              "      <td>9.559999</td>\n",
              "      <td>0.00</td>\n",
              "      <td>...</td>\n",
              "      <td>VLN KING CIGARETTES 10/20C</td>\n",
              "      <td>Tobacco</td>\n",
              "      <td>Core</td>\n",
              "      <td>NaN</td>\n",
              "      <td>VLN King Cigarettes</td>\n",
              "      <td>NASCO Products</td>\n",
              "      <td>3892473169314085043</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>80233.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3995527</th>\n",
              "      <td>2389148903835685831</td>\n",
              "      <td>1219077194660596578</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-10-06</td>\n",
              "      <td>2022-10-01</td>\n",
              "      <td>2.0</td>\n",
              "      <td>141.539993</td>\n",
              "      <td>141.539993</td>\n",
              "      <td>26.459993</td>\n",
              "      <td>3.12</td>\n",
              "      <td>...</td>\n",
              "      <td>VLN MENTHOL KING CIGARETTES 10/20C</td>\n",
              "      <td>Tobacco</td>\n",
              "      <td>Core</td>\n",
              "      <td>NaN</td>\n",
              "      <td>VLN Menthol King Cigarettes</td>\n",
              "      <td>NASCO Products</td>\n",
              "      <td>2389148903835685831</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Convenience</td>\n",
              "      <td>80102.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2370883</th>\n",
              "      <td>1826133453691379178</td>\n",
              "      <td>6673449460752341999</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-12-09</td>\n",
              "      <td>2022-12-01</td>\n",
              "      <td>1.0</td>\n",
              "      <td>70.769997</td>\n",
              "      <td>70.769997</td>\n",
              "      <td>12.229997</td>\n",
              "      <td>1.56</td>\n",
              "      <td>...</td>\n",
              "      <td>VLN KING CIGARETTES 10/20C</td>\n",
              "      <td>Tobacco</td>\n",
              "      <td>Core</td>\n",
              "      <td>NaN</td>\n",
              "      <td>VLN King Cigarettes</td>\n",
              "      <td>NASCO Products</td>\n",
              "      <td>1826133453691379178</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Convenience</td>\n",
              "      <td>80005.0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>430 rows × 23 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-fac64823-65c8-4b49-892b-720ff4638929')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-fac64823-65c8-4b49-892b-720ff4638929 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-fac64823-65c8-4b49-892b-720ff4638929');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe"
            }
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "If we analyse the columns \"description\", \"type\" and \"brand\", we'll see that their groupings on the entire dataframe are entirely null and with the same length (430 rows), so there's no value to replace the others. Furthermore, searching beyond on internet, the establishments who sell these type of poducts majority classify it subcategory as \"Cigarettes\", so will we."
      ],
      "metadata": {
        "id": "DLJk0IPCS0Bh"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Replace 430 missing values by \"Cigarettes\" value\n",
        "df_pdv[\"subcategory\"] = sample_subc[\"subcategory\"].fillna(\"Cigarettes\")\n",
        "# Confirm if ther is any missing value\n",
        "print(f\"Remaining nulls: {df_pdv[\"subcategory\"].isna().sum()}\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "dwU7rDNJSSI8",
        "outputId": "7fd3bbe3-2649-433f-bf61-2b1510ebad96"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Remaining nulls: 0\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Now let's go to the third table part, we're going to fill \"pdv\" missing values with \"internal_store_id\" matching values in the same row as one is foreign key of the other."
      ],
      "metadata": {
        "id": "mmzSmbx7Rb4a"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "EWPcNdqWgyhu"
      },
      "outputs": [],
      "source": [
        "# Fill pdv_id by internal_store_id column matching values\n",
        "df_pdv[\"pdv_id\"] = df_pdv[\"pdv_id\"].fillna(df_pdv[\"internal_store_id\"])"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "To end the missing data replacement, we will replace \"premise\", \"categoria_pdv\" and \"zipcode\" values by it mode."
      ],
      "metadata": {
        "id": "WAj3flORVWMa"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "_y1AlI4nJQFD"
      },
      "outputs": [],
      "source": [
        "# Missing columns to be replaaced\n",
        "cols = [\"premise\", \"pdv_category\", \"zipcode\"]\n",
        "for c in cols:\n",
        "  df_pdv[c] = df_pdv[c].fillna(df_pdv[c].mode()[0]) # Missing column values Replaced by their modes"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Now let's check up if there still any missing value."
      ],
      "metadata": {
        "id": "p40myrXOXIpw"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Check missing values\n",
        "df_pdv.isna().sum()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 843
        },
        "id": "IBnYd4BMydZs",
        "outputId": "deb335f3-e109-4003-8b57-a3b4f0352110"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "internal_store_id      0\n",
              "internal_product_id    0\n",
              "distributor_id         0\n",
              "transaction_date       0\n",
              "reference_date         0\n",
              "quantity               0\n",
              "gross_value            0\n",
              "net_value              0\n",
              "gross_profit           0\n",
              "discount               0\n",
              "taxes                  0\n",
              "product_id             0\n",
              "category               0\n",
              "description            0\n",
              "type                   0\n",
              "label                  0\n",
              "subcategory            0\n",
              "brand                  0\n",
              "manufacturer           0\n",
              "pdv_id                 0\n",
              "premise                0\n",
              "pdv_category           0\n",
              "zipcode                0\n",
              "dtype: int64"
            ],
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>0</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>internal_store_id</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>internal_product_id</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>distributor_id</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>transaction_date</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>reference_date</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>quantity</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>gross_value</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>net_value</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>gross_profit</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>discount</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>taxes</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>product_id</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>category</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>description</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>type</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>label</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>subcategory</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>brand</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>manufacturer</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>pdv_id</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>premise</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>pdv_category</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>zipcode</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div><br><label><b>dtype:</b> int64</label>"
            ]
          },
          "metadata": {},
          "execution_count": 14
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Great! Now let's see the duplicated rows on the entire dataframe."
      ],
      "metadata": {
        "id": "-RjcKNLHXT6D"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "gEIXpBrb5U0t",
        "outputId": "e2add56a-b879-475d-8496-13ced220d181"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "np.False_"
            ]
          },
          "metadata": {},
          "execution_count": 15
        }
      ],
      "source": [
        "# Check duplicated rows\n",
        "df_pdv.duplicated().any()"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Now let's describe all the dataframe numeric columns metrics."
      ],
      "metadata": {
        "id": "0oiMu0fpoRLX"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 320
        },
        "id": "WLs5EHur6aIg",
        "outputId": "b6a35186-e178-4ff6-8b6c-188ee73fddfc"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "           quantity   gross_value     net_value  gross_profit      discount  \\\n",
              "count  6.560698e+06  6.560698e+06  6.560698e+06  6.560698e+06  6.560698e+06   \n",
              "mean   8.125893e+00  1.227512e+02  1.191233e+02  2.193092e+01  2.766684e+01   \n",
              "std    8.049387e+01  8.664265e+02  8.651757e+02  2.326470e+02  3.847624e+02   \n",
              "min   -1.530000e+03 -4.267290e+04 -3.984800e+04 -2.743960e+05 -1.309680e+04   \n",
              "25%    1.000000e+00  2.803500e+01  2.711032e+01  7.140242e+00  0.000000e+00   \n",
              "50%    2.000000e+00  4.210000e+01  4.077048e+01  1.051024e+01  2.300000e+00   \n",
              "75%    4.000000e+00  9.200000e+01  8.787900e+01  2.173200e+01  8.700000e+00   \n",
              "max    9.423000e+04  6.041739e+05  6.041739e+05  2.744160e+05  2.400830e+05   \n",
              "\n",
              "              taxes       zipcode  \n",
              "count  6.560698e+06  6.560698e+06  \n",
              "mean   3.627938e+00  5.844965e+04  \n",
              "std    1.130985e+01  2.491953e+04  \n",
              "min   -4.099409e+03  8.107000e+03  \n",
              "25%    1.800000e-01  3.016100e+04  \n",
              "50%    5.400000e-01  8.002100e+04  \n",
              "75%    3.039677e+00  8.050100e+04  \n",
              "max    2.073238e+03  9.092000e+04  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-328a2221-8ee5-465e-b2a8-699bb3d85637\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>quantity</th>\n",
              "      <th>gross_value</th>\n",
              "      <th>net_value</th>\n",
              "      <th>gross_profit</th>\n",
              "      <th>discount</th>\n",
              "      <th>taxes</th>\n",
              "      <th>zipcode</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>count</th>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>mean</th>\n",
              "      <td>8.125893e+00</td>\n",
              "      <td>1.227512e+02</td>\n",
              "      <td>1.191233e+02</td>\n",
              "      <td>2.193092e+01</td>\n",
              "      <td>2.766684e+01</td>\n",
              "      <td>3.627938e+00</td>\n",
              "      <td>5.844965e+04</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>std</th>\n",
              "      <td>8.049387e+01</td>\n",
              "      <td>8.664265e+02</td>\n",
              "      <td>8.651757e+02</td>\n",
              "      <td>2.326470e+02</td>\n",
              "      <td>3.847624e+02</td>\n",
              "      <td>1.130985e+01</td>\n",
              "      <td>2.491953e+04</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>min</th>\n",
              "      <td>-1.530000e+03</td>\n",
              "      <td>-4.267290e+04</td>\n",
              "      <td>-3.984800e+04</td>\n",
              "      <td>-2.743960e+05</td>\n",
              "      <td>-1.309680e+04</td>\n",
              "      <td>-4.099409e+03</td>\n",
              "      <td>8.107000e+03</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>25%</th>\n",
              "      <td>1.000000e+00</td>\n",
              "      <td>2.803500e+01</td>\n",
              "      <td>2.711032e+01</td>\n",
              "      <td>7.140242e+00</td>\n",
              "      <td>0.000000e+00</td>\n",
              "      <td>1.800000e-01</td>\n",
              "      <td>3.016100e+04</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>50%</th>\n",
              "      <td>2.000000e+00</td>\n",
              "      <td>4.210000e+01</td>\n",
              "      <td>4.077048e+01</td>\n",
              "      <td>1.051024e+01</td>\n",
              "      <td>2.300000e+00</td>\n",
              "      <td>5.400000e-01</td>\n",
              "      <td>8.002100e+04</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>75%</th>\n",
              "      <td>4.000000e+00</td>\n",
              "      <td>9.200000e+01</td>\n",
              "      <td>8.787900e+01</td>\n",
              "      <td>2.173200e+01</td>\n",
              "      <td>8.700000e+00</td>\n",
              "      <td>3.039677e+00</td>\n",
              "      <td>8.050100e+04</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>max</th>\n",
              "      <td>9.423000e+04</td>\n",
              "      <td>6.041739e+05</td>\n",
              "      <td>6.041739e+05</td>\n",
              "      <td>2.744160e+05</td>\n",
              "      <td>2.400830e+05</td>\n",
              "      <td>2.073238e+03</td>\n",
              "      <td>9.092000e+04</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-328a2221-8ee5-465e-b2a8-699bb3d85637')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-328a2221-8ee5-465e-b2a8-699bb3d85637 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-328a2221-8ee5-465e-b2a8-699bb3d85637');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "summary": "{\n  \"name\": \"df_pdv\",\n  \"rows\": 8,\n  \"fields\": [\n    {\n      \"column\": \"quantity\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2315106.221538256,\n        \"min\": -1530.0,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          8.125893322711079,\n          2.0,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"gross_value\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2301143.8500076844,\n        \"min\": -42672.8984375,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          122.75123329215806,\n          42.099998474121094,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"net_value\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2300981.0447639236,\n        \"min\": -39848.00004577637,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          119.12329555086549,\n          40.770484924316406,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"gross_profit\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2324174.0734313084,\n        \"min\": -274396.0,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          21.93092088627153,\n          10.51024055480957,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"discount\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2309631.0516223176,\n        \"min\": -13096.7998046875,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          27.66683508569789,\n          2.299999952316284,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"taxes\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2319659.0474007465,\n        \"min\": -4099.40869140625,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          3.6279376285221328,\n          0.5400000214576721,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"zipcode\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2300908.6084488723,\n        \"min\": 8107.0,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          58449.65049816346,\n          80021.0,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 16
        }
      ],
      "source": [
        "# Show all the metrics from numeric columns\n",
        "df_pdv.describe()"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Let's take a closer look on these numeric numbers."
      ],
      "metadata": {
        "id": "qJmzLK3LofGF"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Show first 50 rows of selected numeric columns\n",
        "display(df_pdv[[\"quantity\", \"gross_value\", \"net_value\", \"gross_profit\", \"discount\", \"taxes\", \"zipcode\"]].head(50))"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "id": "LKMCR-MCorYJ",
        "outputId": "47168d9e-759f-48d2-abe8-c661f4a9264e"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "      quantity  gross_value    net_value  gross_profit     discount  \\\n",
              "0     1.000000    38.125000    37.890625     10.042625     3.950000   \n",
              "1     6.000000   107.250000   106.440002     24.732002    17.100000   \n",
              "2     3.000000    56.625000    56.220001     14.124002     5.250000   \n",
              "3   129.000000  1037.160023  1037.160023    156.348026   479.880006   \n",
              "4     1.000000    26.230000    23.950241      6.550241     0.000000   \n",
              "5    48.000000   239.520004   239.520004     37.839989    47.040001   \n",
              "6     7.000000   153.754997   133.807114     40.518112    23.450000   \n",
              "7    45.999990  2035.279598  2035.279598    517.279939   123.639971   \n",
              "8    12.000000   223.703999   203.186169     54.818170    15.600000   \n",
              "9     1.000000    42.799999    42.619999     12.772999     6.180000   \n",
              "10  159.000000  1773.359987  1773.359987    368.860039   497.449942   \n",
              "11    2.000000    18.500000    18.500000      4.518330     6.100000   \n",
              "12    3.000000    80.250000    73.410728     20.727728     0.000000   \n",
              "13    1.000000    19.743999    16.704323      4.090323     1.850000   \n",
              "14   14.000010   228.200150   228.200150     69.533373    12.500012   \n",
              "15  234.000000  2244.839905  2244.839905    485.159908   695.759930   \n",
              "16    6.000000   102.599998    96.273033      8.533035    12.619998   \n",
              "17  139.999799  2103.348167  2103.348167   -342.214966   525.838110   \n",
              "18    2.000000    56.000000    55.625000     16.490999     0.000000   \n",
              "19    1.000000   147.000000   136.000000     60.813999     0.000000   \n",
              "20   79.000008  1272.010361  1272.010361   -107.988087   211.579808   \n",
              "21    1.000000    31.500000    31.265625      8.260625     3.900000   \n",
              "22    2.000000    38.750000    38.750000      9.750000     4.800000   \n",
              "23    1.000000    20.150000    20.000000      4.543000     3.500000   \n",
              "24    1.000000    23.725000    23.545000      5.087000     3.950000   \n",
              "25    7.000000   143.850006   123.902122     39.167122     2.800000   \n",
              "26   10.000000   218.229996   195.432419     46.442417    32.500000   \n",
              "27    1.000000    32.849998    32.615623     10.726624     0.000000   \n",
              "28    7.000000   159.634995   143.676682     36.135681    12.950000   \n",
              "29    2.000000    63.740002    63.380001     17.418001     1.600000   \n",
              "30   48.000000  2184.120020  2184.120020   -221.159981  1007.879982   \n",
              "31    3.000000    69.599998    60.480968     17.025969     0.000000   \n",
              "32    1.000000    25.200001    25.020000      6.427369     2.300000   \n",
              "33    2.000000    55.099998    50.540482     14.760482     0.000000   \n",
              "34    0.000000   -16.200005   -16.200005    -16.200005     0.000000   \n",
              "35    2.000000    65.599998    65.119995     16.397995     6.000000   \n",
              "36    1.000000    28.650000    26.370241      7.280241     0.000000   \n",
              "37    1.000000    20.879999    20.879999      4.129999     3.750000   \n",
              "38    2.000000    51.450001    51.090000     13.044001     3.900000   \n",
              "39    1.000000    27.000000    26.820000      8.580000     0.000000   \n",
              "40   -1.000000   -28.799999   -25.760323     -7.285323     0.000000   \n",
              "41    4.000000    79.000000    67.601212     19.181211     1.600000   \n",
              "42    1.000000    23.350000    23.115625      4.777626     5.100000   \n",
              "43    1.000000    32.025002    31.797388      9.768388     2.150000   \n",
              "44  300.000000  6720.000000  6403.651794    426.651909  1200.000000   \n",
              "45   10.000000   209.250000   207.990005     62.150005    18.500000   \n",
              "46  168.000000  1367.800064  1367.800064    367.500000   233.800064   \n",
              "47  303.000000  1933.540077  1933.540077   -182.662528  1059.849998   \n",
              "48    2.000000    55.099998    50.540482     13.148481     0.000000   \n",
              "49    1.000000    26.650000    24.370241      8.230241     0.000000   \n",
              "\n",
              "         taxes  zipcode  \n",
              "0     0.234375  80905.0  \n",
              "1     0.810000  80239.0  \n",
              "2     0.405000  80634.0  \n",
              "3     0.000000  80226.0  \n",
              "4     2.279758  30096.0  \n",
              "5     0.000000  81122.0  \n",
              "6    19.947886  30720.0  \n",
              "7     0.000000  80224.0  \n",
              "8    20.517828  30107.0  \n",
              "9     0.180000  80232.0  \n",
              "10    0.000000  80204.0  \n",
              "11    0.000000  30338.0  \n",
              "12    6.839274  30121.0  \n",
              "13    3.039677  30043.0  \n",
              "14    0.000000  80222.0  \n",
              "15    0.000000  80758.0  \n",
              "16    6.326964  80534.0  \n",
              "17    0.000000  80203.0  \n",
              "18    0.375000  80601.0  \n",
              "19   11.000000  30087.0  \n",
              "20    0.000000  80107.0  \n",
              "21    0.234375  80118.0  \n",
              "22    0.000000  80915.0  \n",
              "23    0.150000  80004.0  \n",
              "24    0.180000  80134.0  \n",
              "25   19.947886  30115.0  \n",
              "26   22.797581  30084.0  \n",
              "27    0.234375  80220.0  \n",
              "28   15.958306  30721.0  \n",
              "29    0.360000  80209.0  \n",
              "30    0.000000  80204.0  \n",
              "31    9.119031  30188.0  \n",
              "32    0.180000  80920.0  \n",
              "33    4.559516  30720.0  \n",
              "34    0.000000  80108.0  \n",
              "35    0.480000  80911.0  \n",
              "36    2.279758  30701.0  \n",
              "37    0.000000  30753.0  \n",
              "38    0.360000  80601.0  \n",
              "39    0.180000  80241.0  \n",
              "40   -3.039677  30078.0  \n",
              "41   11.398792  30540.0  \n",
              "42    0.234375  80017.0  \n",
              "43    0.227613  80904.0  \n",
              "44  316.348200  80215.0  \n",
              "45    1.260000  80016.0  \n",
              "46    0.000000  80525.0  \n",
              "47    0.000000  80916.0  \n",
              "48    4.559516  30755.0  \n",
              "49    2.279758  30047.0  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-ef6c2cd4-11ff-49e1-9d41-0c776e7f5ee1\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>quantity</th>\n",
              "      <th>gross_value</th>\n",
              "      <th>net_value</th>\n",
              "      <th>gross_profit</th>\n",
              "      <th>discount</th>\n",
              "      <th>taxes</th>\n",
              "      <th>zipcode</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>38.125000</td>\n",
              "      <td>37.890625</td>\n",
              "      <td>10.042625</td>\n",
              "      <td>3.950000</td>\n",
              "      <td>0.234375</td>\n",
              "      <td>80905.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>6.000000</td>\n",
              "      <td>107.250000</td>\n",
              "      <td>106.440002</td>\n",
              "      <td>24.732002</td>\n",
              "      <td>17.100000</td>\n",
              "      <td>0.810000</td>\n",
              "      <td>80239.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>3.000000</td>\n",
              "      <td>56.625000</td>\n",
              "      <td>56.220001</td>\n",
              "      <td>14.124002</td>\n",
              "      <td>5.250000</td>\n",
              "      <td>0.405000</td>\n",
              "      <td>80634.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>129.000000</td>\n",
              "      <td>1037.160023</td>\n",
              "      <td>1037.160023</td>\n",
              "      <td>156.348026</td>\n",
              "      <td>479.880006</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>80226.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>26.230000</td>\n",
              "      <td>23.950241</td>\n",
              "      <td>6.550241</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>2.279758</td>\n",
              "      <td>30096.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>5</th>\n",
              "      <td>48.000000</td>\n",
              "      <td>239.520004</td>\n",
              "      <td>239.520004</td>\n",
              "      <td>37.839989</td>\n",
              "      <td>47.040001</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>81122.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6</th>\n",
              "      <td>7.000000</td>\n",
              "      <td>153.754997</td>\n",
              "      <td>133.807114</td>\n",
              "      <td>40.518112</td>\n",
              "      <td>23.450000</td>\n",
              "      <td>19.947886</td>\n",
              "      <td>30720.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>7</th>\n",
              "      <td>45.999990</td>\n",
              "      <td>2035.279598</td>\n",
              "      <td>2035.279598</td>\n",
              "      <td>517.279939</td>\n",
              "      <td>123.639971</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>80224.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>8</th>\n",
              "      <td>12.000000</td>\n",
              "      <td>223.703999</td>\n",
              "      <td>203.186169</td>\n",
              "      <td>54.818170</td>\n",
              "      <td>15.600000</td>\n",
              "      <td>20.517828</td>\n",
              "      <td>30107.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>9</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>42.799999</td>\n",
              "      <td>42.619999</td>\n",
              "      <td>12.772999</td>\n",
              "      <td>6.180000</td>\n",
              "      <td>0.180000</td>\n",
              "      <td>80232.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10</th>\n",
              "      <td>159.000000</td>\n",
              "      <td>1773.359987</td>\n",
              "      <td>1773.359987</td>\n",
              "      <td>368.860039</td>\n",
              "      <td>497.449942</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>80204.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>11</th>\n",
              "      <td>2.000000</td>\n",
              "      <td>18.500000</td>\n",
              "      <td>18.500000</td>\n",
              "      <td>4.518330</td>\n",
              "      <td>6.100000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>30338.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>12</th>\n",
              "      <td>3.000000</td>\n",
              "      <td>80.250000</td>\n",
              "      <td>73.410728</td>\n",
              "      <td>20.727728</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>6.839274</td>\n",
              "      <td>30121.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>13</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>19.743999</td>\n",
              "      <td>16.704323</td>\n",
              "      <td>4.090323</td>\n",
              "      <td>1.850000</td>\n",
              "      <td>3.039677</td>\n",
              "      <td>30043.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>14</th>\n",
              "      <td>14.000010</td>\n",
              "      <td>228.200150</td>\n",
              "      <td>228.200150</td>\n",
              "      <td>69.533373</td>\n",
              "      <td>12.500012</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>80222.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>15</th>\n",
              "      <td>234.000000</td>\n",
              "      <td>2244.839905</td>\n",
              "      <td>2244.839905</td>\n",
              "      <td>485.159908</td>\n",
              "      <td>695.759930</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>80758.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>16</th>\n",
              "      <td>6.000000</td>\n",
              "      <td>102.599998</td>\n",
              "      <td>96.273033</td>\n",
              "      <td>8.533035</td>\n",
              "      <td>12.619998</td>\n",
              "      <td>6.326964</td>\n",
              "      <td>80534.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>17</th>\n",
              "      <td>139.999799</td>\n",
              "      <td>2103.348167</td>\n",
              "      <td>2103.348167</td>\n",
              "      <td>-342.214966</td>\n",
              "      <td>525.838110</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>80203.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>18</th>\n",
              "      <td>2.000000</td>\n",
              "      <td>56.000000</td>\n",
              "      <td>55.625000</td>\n",
              "      <td>16.490999</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.375000</td>\n",
              "      <td>80601.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>19</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>147.000000</td>\n",
              "      <td>136.000000</td>\n",
              "      <td>60.813999</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>11.000000</td>\n",
              "      <td>30087.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>20</th>\n",
              "      <td>79.000008</td>\n",
              "      <td>1272.010361</td>\n",
              "      <td>1272.010361</td>\n",
              "      <td>-107.988087</td>\n",
              "      <td>211.579808</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>80107.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>21</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>31.500000</td>\n",
              "      <td>31.265625</td>\n",
              "      <td>8.260625</td>\n",
              "      <td>3.900000</td>\n",
              "      <td>0.234375</td>\n",
              "      <td>80118.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>22</th>\n",
              "      <td>2.000000</td>\n",
              "      <td>38.750000</td>\n",
              "      <td>38.750000</td>\n",
              "      <td>9.750000</td>\n",
              "      <td>4.800000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>80915.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>23</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>20.150000</td>\n",
              "      <td>20.000000</td>\n",
              "      <td>4.543000</td>\n",
              "      <td>3.500000</td>\n",
              "      <td>0.150000</td>\n",
              "      <td>80004.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>24</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>23.725000</td>\n",
              "      <td>23.545000</td>\n",
              "      <td>5.087000</td>\n",
              "      <td>3.950000</td>\n",
              "      <td>0.180000</td>\n",
              "      <td>80134.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>25</th>\n",
              "      <td>7.000000</td>\n",
              "      <td>143.850006</td>\n",
              "      <td>123.902122</td>\n",
              "      <td>39.167122</td>\n",
              "      <td>2.800000</td>\n",
              "      <td>19.947886</td>\n",
              "      <td>30115.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>26</th>\n",
              "      <td>10.000000</td>\n",
              "      <td>218.229996</td>\n",
              "      <td>195.432419</td>\n",
              "      <td>46.442417</td>\n",
              "      <td>32.500000</td>\n",
              "      <td>22.797581</td>\n",
              "      <td>30084.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>27</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>32.849998</td>\n",
              "      <td>32.615623</td>\n",
              "      <td>10.726624</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.234375</td>\n",
              "      <td>80220.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>28</th>\n",
              "      <td>7.000000</td>\n",
              "      <td>159.634995</td>\n",
              "      <td>143.676682</td>\n",
              "      <td>36.135681</td>\n",
              "      <td>12.950000</td>\n",
              "      <td>15.958306</td>\n",
              "      <td>30721.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29</th>\n",
              "      <td>2.000000</td>\n",
              "      <td>63.740002</td>\n",
              "      <td>63.380001</td>\n",
              "      <td>17.418001</td>\n",
              "      <td>1.600000</td>\n",
              "      <td>0.360000</td>\n",
              "      <td>80209.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>30</th>\n",
              "      <td>48.000000</td>\n",
              "      <td>2184.120020</td>\n",
              "      <td>2184.120020</td>\n",
              "      <td>-221.159981</td>\n",
              "      <td>1007.879982</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>80204.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>31</th>\n",
              "      <td>3.000000</td>\n",
              "      <td>69.599998</td>\n",
              "      <td>60.480968</td>\n",
              "      <td>17.025969</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>9.119031</td>\n",
              "      <td>30188.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>32</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>25.200001</td>\n",
              "      <td>25.020000</td>\n",
              "      <td>6.427369</td>\n",
              "      <td>2.300000</td>\n",
              "      <td>0.180000</td>\n",
              "      <td>80920.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>33</th>\n",
              "      <td>2.000000</td>\n",
              "      <td>55.099998</td>\n",
              "      <td>50.540482</td>\n",
              "      <td>14.760482</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>4.559516</td>\n",
              "      <td>30720.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>34</th>\n",
              "      <td>0.000000</td>\n",
              "      <td>-16.200005</td>\n",
              "      <td>-16.200005</td>\n",
              "      <td>-16.200005</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>80108.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>35</th>\n",
              "      <td>2.000000</td>\n",
              "      <td>65.599998</td>\n",
              "      <td>65.119995</td>\n",
              "      <td>16.397995</td>\n",
              "      <td>6.000000</td>\n",
              "      <td>0.480000</td>\n",
              "      <td>80911.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>36</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>28.650000</td>\n",
              "      <td>26.370241</td>\n",
              "      <td>7.280241</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>2.279758</td>\n",
              "      <td>30701.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>37</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>20.879999</td>\n",
              "      <td>20.879999</td>\n",
              "      <td>4.129999</td>\n",
              "      <td>3.750000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>30753.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>38</th>\n",
              "      <td>2.000000</td>\n",
              "      <td>51.450001</td>\n",
              "      <td>51.090000</td>\n",
              "      <td>13.044001</td>\n",
              "      <td>3.900000</td>\n",
              "      <td>0.360000</td>\n",
              "      <td>80601.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>39</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>27.000000</td>\n",
              "      <td>26.820000</td>\n",
              "      <td>8.580000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.180000</td>\n",
              "      <td>80241.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>40</th>\n",
              "      <td>-1.000000</td>\n",
              "      <td>-28.799999</td>\n",
              "      <td>-25.760323</td>\n",
              "      <td>-7.285323</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>-3.039677</td>\n",
              "      <td>30078.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>41</th>\n",
              "      <td>4.000000</td>\n",
              "      <td>79.000000</td>\n",
              "      <td>67.601212</td>\n",
              "      <td>19.181211</td>\n",
              "      <td>1.600000</td>\n",
              "      <td>11.398792</td>\n",
              "      <td>30540.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>42</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>23.350000</td>\n",
              "      <td>23.115625</td>\n",
              "      <td>4.777626</td>\n",
              "      <td>5.100000</td>\n",
              "      <td>0.234375</td>\n",
              "      <td>80017.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>43</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>32.025002</td>\n",
              "      <td>31.797388</td>\n",
              "      <td>9.768388</td>\n",
              "      <td>2.150000</td>\n",
              "      <td>0.227613</td>\n",
              "      <td>80904.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>44</th>\n",
              "      <td>300.000000</td>\n",
              "      <td>6720.000000</td>\n",
              "      <td>6403.651794</td>\n",
              "      <td>426.651909</td>\n",
              "      <td>1200.000000</td>\n",
              "      <td>316.348200</td>\n",
              "      <td>80215.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>45</th>\n",
              "      <td>10.000000</td>\n",
              "      <td>209.250000</td>\n",
              "      <td>207.990005</td>\n",
              "      <td>62.150005</td>\n",
              "      <td>18.500000</td>\n",
              "      <td>1.260000</td>\n",
              "      <td>80016.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>46</th>\n",
              "      <td>168.000000</td>\n",
              "      <td>1367.800064</td>\n",
              "      <td>1367.800064</td>\n",
              "      <td>367.500000</td>\n",
              "      <td>233.800064</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>80525.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>47</th>\n",
              "      <td>303.000000</td>\n",
              "      <td>1933.540077</td>\n",
              "      <td>1933.540077</td>\n",
              "      <td>-182.662528</td>\n",
              "      <td>1059.849998</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>80916.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>48</th>\n",
              "      <td>2.000000</td>\n",
              "      <td>55.099998</td>\n",
              "      <td>50.540482</td>\n",
              "      <td>13.148481</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>4.559516</td>\n",
              "      <td>30755.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>49</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>26.650000</td>\n",
              "      <td>24.370241</td>\n",
              "      <td>8.230241</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>2.279758</td>\n",
              "      <td>30047.0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ef6c2cd4-11ff-49e1-9d41-0c776e7f5ee1')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-ef6c2cd4-11ff-49e1-9d41-0c776e7f5ee1 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-ef6c2cd4-11ff-49e1-9d41-0c776e7f5ee1');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "summary": "{\n  \"name\": \"display(df_pdv[[\\\"quantity\\\", \\\"gross_value\\\", \\\"net_value\\\", \\\"gross_profit\\\", \\\"discount\\\", \\\"taxes\\\", \\\"zipcode\\\"]]\",\n  \"rows\": 50,\n  \"fields\": [\n    {\n      \"column\": \"quantity\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 75.18309324995327,\n        \"min\": -1.0,\n        \"max\": 303.0,\n        \"num_unique_values\": 21,\n        \"samples\": [\n          1.0,\n          4.0,\n          0.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"gross_value\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 1126.9071782734961,\n        \"min\": -28.799999237060547,\n        \"max\": 6720.0,\n        \"num_unique_values\": 49,\n        \"samples\": [\n          19.743999481201172,\n          209.25,\n          1933.5400772094727\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"net_value\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 1092.832586270856,\n        \"min\": -25.76032257080078,\n        \"max\": 6403.651794433594,\n        \"num_unique_values\": 49,\n        \"samples\": [\n          16.704322814941406,\n          207.99000549316406,\n          1933.5400772094727\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"gross_profit\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 151.31195926648064,\n        \"min\": -342.21496629714966,\n        \"max\": 517.2799386978149,\n        \"num_unique_values\": 50,\n        \"samples\": [\n          4.090322971343994,\n          8.579999923706055,\n          -221.15998077392578\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"discount\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 290.8356274079533,\n        \"min\": 0.0,\n        \"max\": 1200.0,\n        \"num_unique_values\": 35,\n        \"samples\": [\n          2.299999952316284,\n          12.500011652708054,\n          1.600000023841858\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"taxes\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 44.702234063407744,\n        \"min\": -3.0396769046783447,\n        \"max\": 316.34819984436035,\n        \"num_unique_values\": 26,\n        \"samples\": [\n          6.839273929595947,\n          15.958306312561035,\n          0.234375\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"zipcode\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 24281.28837940181,\n        \"min\": 30043.0,\n        \"max\": 81122.0,\n        \"num_unique_values\": 47,\n        \"samples\": [\n          80220.0,\n          80017.0,\n          30084.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "As we can see, the US standard zipcode is of five numbers, we have to fit these numbers on this shape for meeting the requirements."
      ],
      "metadata": {
        "id": "aLH536LsoxYl"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "df_pdv[\"zipcode\"] = ( # Apply the changes to the \"zipcode\" column\n",
        "    df_pdv[\"zipcode\"] # Choose which column will be treated\n",
        "    .astype(int)      # Convert Float to Integer (This remove .0 or extra decimals)\n",
        "    .astype(str)      # Convert to string\n",
        "    .str.zfill(5)     # Adds zeros to the left if they have less than 5 digits\n",
        "    .str.slice(0, 5)  # Slice the excess to the right if they have more than 5 digits\n",
        ")\n",
        "\n",
        "# Visualize the results\n",
        "display(df_pdv[\"zipcode\"])"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 565
        },
        "id": "2cU4VExHj7U-",
        "outputId": "6b5f89f3-d25b-421a-84bc-65de7c64b8dd"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "0          80905\n",
              "1          80239\n",
              "2          80634\n",
              "3          80226\n",
              "4          30096\n",
              "           ...  \n",
              "6560693    30071\n",
              "6560694    30076\n",
              "6560695    30121\n",
              "6560696    80602\n",
              "6560697    30058\n",
              "Name: zipcode, Length: 6560698, dtype: object"
            ],
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>zipcode</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>80905</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>80239</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>80634</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>80226</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>30096</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560693</th>\n",
              "      <td>30071</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560694</th>\n",
              "      <td>30076</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560695</th>\n",
              "      <td>30121</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560696</th>\n",
              "      <td>80602</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560697</th>\n",
              "      <td>30058</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>6560698 rows × 1 columns</p>\n",
              "</div><br><label><b>dtype:</b> object</label>"
            ]
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Now, we have to convert the \"quantity\", \"gross_value\", \"net_value\", \"discount\" and \"taxes\" values to positive and around \"quantity\"."
      ],
      "metadata": {
        "id": "c2nrertRp2NX"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "P38mP_aPGEJo"
      },
      "outputs": [],
      "source": [
        "# Do modulation of the numbers\n",
        "df_pdv[[\"quantity\", \"gross_value\", \"net_value\", \"gross_profit\", \"discount\", \"taxes\"]] = df_pdv[[\"quantity\", \"gross_value\", \"net_value\", \"gross_profit\", \"discount\", \"taxes\"]].abs()\n",
        "# Round the numbers\n",
        "df_pdv[\"quantity\"] = df_pdv[\"quantity\"].round()"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Let's see the numeric columns metrics again."
      ],
      "metadata": {
        "id": "QTQ6sXkKOmrB"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Show all the metrics from numeric columns\n",
        "df_pdv.describe()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 320
        },
        "id": "37KdBPjgOnLJ",
        "outputId": "e2e5b8bd-3a9d-411f-d7fc-b6616fb845e2"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "           quantity   gross_value     net_value  gross_profit      discount  \\\n",
              "count  6.560698e+06  6.560698e+06  6.560698e+06  6.560698e+06  6.560698e+06   \n",
              "mean   8.189637e+00  1.243932e+02  1.207002e+02  2.808858e+01  2.780006e+01   \n",
              "std    8.048743e+01  8.661923e+02  8.649571e+02  2.319841e+02  3.847528e+02   \n",
              "min    0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   \n",
              "25%    1.000000e+00  2.830000e+01  2.744250e+01  7.363001e+00  0.000000e+00   \n",
              "50%    2.000000e+00  4.257200e+01  4.105048e+01  1.072636e+01  2.350000e+00   \n",
              "75%    4.000000e+00  9.240000e+01  8.830500e+01  2.243400e+01  8.750000e+00   \n",
              "max    9.423000e+04  6.041739e+05  6.041739e+05  2.744160e+05  2.400830e+05   \n",
              "\n",
              "              taxes  \n",
              "count  6.560698e+06  \n",
              "mean   3.694083e+00  \n",
              "std    1.128842e+01  \n",
              "min    0.000000e+00  \n",
              "25%    1.800000e-01  \n",
              "50%    5.400000e-01  \n",
              "75%    3.039677e+00  \n",
              "max    4.099409e+03  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-cb5393b7-137e-425a-8892-0c36a06cd4ad\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>quantity</th>\n",
              "      <th>gross_value</th>\n",
              "      <th>net_value</th>\n",
              "      <th>gross_profit</th>\n",
              "      <th>discount</th>\n",
              "      <th>taxes</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>count</th>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>mean</th>\n",
              "      <td>8.189637e+00</td>\n",
              "      <td>1.243932e+02</td>\n",
              "      <td>1.207002e+02</td>\n",
              "      <td>2.808858e+01</td>\n",
              "      <td>2.780006e+01</td>\n",
              "      <td>3.694083e+00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>std</th>\n",
              "      <td>8.048743e+01</td>\n",
              "      <td>8.661923e+02</td>\n",
              "      <td>8.649571e+02</td>\n",
              "      <td>2.319841e+02</td>\n",
              "      <td>3.847528e+02</td>\n",
              "      <td>1.128842e+01</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>min</th>\n",
              "      <td>0.000000e+00</td>\n",
              "      <td>0.000000e+00</td>\n",
              "      <td>0.000000e+00</td>\n",
              "      <td>0.000000e+00</td>\n",
              "      <td>0.000000e+00</td>\n",
              "      <td>0.000000e+00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>25%</th>\n",
              "      <td>1.000000e+00</td>\n",
              "      <td>2.830000e+01</td>\n",
              "      <td>2.744250e+01</td>\n",
              "      <td>7.363001e+00</td>\n",
              "      <td>0.000000e+00</td>\n",
              "      <td>1.800000e-01</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>50%</th>\n",
              "      <td>2.000000e+00</td>\n",
              "      <td>4.257200e+01</td>\n",
              "      <td>4.105048e+01</td>\n",
              "      <td>1.072636e+01</td>\n",
              "      <td>2.350000e+00</td>\n",
              "      <td>5.400000e-01</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>75%</th>\n",
              "      <td>4.000000e+00</td>\n",
              "      <td>9.240000e+01</td>\n",
              "      <td>8.830500e+01</td>\n",
              "      <td>2.243400e+01</td>\n",
              "      <td>8.750000e+00</td>\n",
              "      <td>3.039677e+00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>max</th>\n",
              "      <td>9.423000e+04</td>\n",
              "      <td>6.041739e+05</td>\n",
              "      <td>6.041739e+05</td>\n",
              "      <td>2.744160e+05</td>\n",
              "      <td>2.400830e+05</td>\n",
              "      <td>4.099409e+03</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-cb5393b7-137e-425a-8892-0c36a06cd4ad')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-cb5393b7-137e-425a-8892-0c36a06cd4ad button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-cb5393b7-137e-425a-8892-0c36a06cd4ad');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "summary": "{\n  \"name\": \"df_pdv\",\n  \"rows\": 8,\n  \"fields\": [\n    {\n      \"column\": \"quantity\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2315027.615660132,\n        \"min\": 0.0,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          8.189636834373415,\n          2.0,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"gross_value\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2298719.9689814183,\n        \"min\": 0.0,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          124.3932119728299,\n          42.571998596191406,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"net_value\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2298720.6035961406,\n        \"min\": 0.0,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          120.70015776766644,\n          41.05048370361328,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"gross_profit\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2307679.751738692,\n        \"min\": 0.0,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          28.088581536877637,\n          10.726359367370605,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"discount\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2308937.609551326,\n        \"min\": 0.0,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 7,\n        \"samples\": [\n          6560698.0,\n          27.800063720924516,\n          8.75\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"taxes\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2319349.467466856,\n        \"min\": 0.0,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          3.6940828198606637,\n          0.5400000214576721,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 20
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "We have to remove the zeros on \"quantity\", \"gross_value\" and \"net_value\" columns, as they represent the product value and can't have zeros on it."
      ],
      "metadata": {
        "id": "0k-jEPPnZrb2"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Columns we want to replace 0s\n",
        "na_cols = [\"quantity\", \"gross_value\", \"net_value\"]\n",
        "gb_cols = [\"internal_store_id\"]\n",
        "# Visualize example\n",
        "display(df_pdv[na_cols][df_pdv[na_cols] == 0])\n",
        "# Replace the specific column values by 0\n",
        "sample_prod = df_pdv[na_cols + gb_cols].replace(0, np.nan).copy()\n",
        "# Sort dataframe column values and get a copy of it\n",
        "sample_prod = sample_prod.sort_values(by=gb_cols).copy()\n",
        "# Give a forward fill grouped by \"product_id\" on na_cols column\n",
        "sample_prod[na_cols] = sample_prod.groupby(gb_cols)[na_cols].ffill()\n",
        "# Give a backward fill grouped by \"product_id\" on na_cols column\n",
        "sample_prod[na_cols] = sample_prod.groupby(gb_cols)[na_cols].bfill()\n",
        "# Get the number of remaining missing values after treatiing the na_cols\n",
        "na_val = sample_prod[na_cols].isna().sum()\n",
        "print(f\"Remaining nulls:\\n{na_val}\") # Print remaining nulls"
      ],
      "metadata": {
        "id": "mkTfBfxTTaXM",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 530
        },
        "outputId": "222e2575-1f0e-489f-8017-9b956f51fe4b"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "         quantity  gross_value  net_value\n",
              "0             NaN          NaN        NaN\n",
              "1             NaN          NaN        NaN\n",
              "2             NaN          NaN        NaN\n",
              "3             NaN          NaN        NaN\n",
              "4             NaN          NaN        NaN\n",
              "...           ...          ...        ...\n",
              "6560693       NaN          NaN        NaN\n",
              "6560694       NaN          NaN        NaN\n",
              "6560695       NaN          NaN        NaN\n",
              "6560696       NaN          NaN        NaN\n",
              "6560697       NaN          NaN        NaN\n",
              "\n",
              "[6560698 rows x 3 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-d33057b1-db5c-4192-977e-e2f68433c4ee\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>quantity</th>\n",
              "      <th>gross_value</th>\n",
              "      <th>net_value</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560693</th>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560694</th>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560695</th>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560696</th>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560697</th>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>6560698 rows × 3 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d33057b1-db5c-4192-977e-e2f68433c4ee')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-d33057b1-db5c-4192-977e-e2f68433c4ee button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-d33057b1-db5c-4192-977e-e2f68433c4ee');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Remaining nulls:\n",
            "quantity       39133\n",
            "gross_value    39179\n",
            "net_value      39179\n",
            "dtype: int64\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Then, we'll replace the rest of the 0 values by mean."
      ],
      "metadata": {
        "id": "prRIaPAdKpsi"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Calculate the mean using ONLY the valid rows\n",
        "mean_quant = sample_prod[na_cols[0]].mean()\n",
        "mean_gross = sample_prod[na_cols[1]].mean()\n",
        "mean_net = sample_prod[na_cols[2]].mean()\n",
        "# Replace the values in the invalid rows with this calculated mean\n",
        "sample_prod[na_cols[0]] = sample_prod[na_cols[0]].fillna(mean_quant)\n",
        "sample_prod[na_cols[1]] = sample_prod[na_cols[1]].fillna(mean_gross)\n",
        "sample_prod[na_cols[2]] = sample_prod[na_cols[2]].fillna(mean_net)\n",
        "# Apply changes\n",
        "df_pdv[na_cols] = sample_prod[na_cols]"
      ],
      "metadata": {
        "id": "mADiL7d0JgWb"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "Also, we have to remove all the rows where the discount plus taxes are greater than gross value, because it gives negative gross profits."
      ],
      "metadata": {
        "id": "IUlxCGF2R_x3"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Define which columns need to be corrected when we find invalid rows\n",
        "neg_cols = [\"discount\", \"taxes\"]\n",
        "gb_cols = [\"internal_store_id\"]\n",
        "# Checks where the sum of discounts and taxes is greater than the gross value\n",
        "neg_fill = (df_pdv[\"discount\"] + df_pdv[\"taxes\"]) > df_pdv[\"gross_value\"]\n",
        "# Visualize example\n",
        "display(df_pdv[neg_fill][[\"discount\", \"taxes\"]])\n",
        "# Copy a fraction of the dataframe\n",
        "sample_neg = df_pdv[neg_cols + gb_cols].copy()\n",
        "# Calculate the valid rows of the dataframe\n",
        "sample_neg.loc[neg_fill, neg_cols] = np.nan\n",
        "# Sort dataframe column values by \"product_id\" and get a copy of it\n",
        "sample_neg = sample_neg.sort_values(by=gb_cols)\n",
        "# Give a forward fill grouped by \"product_id\" on neg_cols\n",
        "sample_neg[neg_cols] = sample_neg.groupby(gb_cols)[neg_cols].ffill()\n",
        "# Give a backward fill grouped by \"product_id\" on neg_cols\n",
        "sample_neg[neg_cols] = sample_neg.groupby(gb_cols)[neg_cols].bfill()\n",
        "# Apply changes\n",
        "# df_pdv[neg_cols] = sample_neg[neg_cols]\n",
        "# Get the number of remaining missing values after treatiing the neg_cols\n",
        "neg_val = sample_neg[neg_cols].isna().sum()\n",
        "print(f\"Remaining nulls:\\n{neg_val}\") # Print remaining nulls"
      ],
      "metadata": {
        "id": "33cKoA6qZqV1",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 513
        },
        "collapsed": true,
        "outputId": "67f67d08-5a08-476b-d762-1e9c4cd850fa"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "            discount     taxes\n",
              "55       3013.129982  0.000000\n",
              "218       274.119919  0.000000\n",
              "225      1417.009964  0.000000\n",
              "255      1106.050026  0.000000\n",
              "402      6849.039932  0.000000\n",
              "...              ...       ...\n",
              "6558262    16.920000  0.465227\n",
              "6559228    65.279999  0.000000\n",
              "6559557   242.250000  2.700000\n",
              "6559595    66.099998  0.000000\n",
              "6560092   149.719995  0.000000\n",
              "\n",
              "[37161 rows x 2 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-69f09801-9920-408f-a848-dffcc6488066\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>discount</th>\n",
              "      <th>taxes</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>55</th>\n",
              "      <td>3013.129982</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>218</th>\n",
              "      <td>274.119919</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>225</th>\n",
              "      <td>1417.009964</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>255</th>\n",
              "      <td>1106.050026</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>402</th>\n",
              "      <td>6849.039932</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6558262</th>\n",
              "      <td>16.920000</td>\n",
              "      <td>0.465227</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6559228</th>\n",
              "      <td>65.279999</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6559557</th>\n",
              "      <td>242.250000</td>\n",
              "      <td>2.700000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6559595</th>\n",
              "      <td>66.099998</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560092</th>\n",
              "      <td>149.719995</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>37161 rows × 2 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-69f09801-9920-408f-a848-dffcc6488066')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-69f09801-9920-408f-a848-dffcc6488066 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-69f09801-9920-408f-a848-dffcc6488066');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "summary": "{\n  \"name\": \"print(f\\\"Remaining nulls:\\\\n{neg_val}\\\") # Print remaining nulls\",\n  \"rows\": 37161,\n  \"fields\": [\n    {\n      \"column\": \"discount\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3732.9144923880735,\n        \"min\": 0.0,\n        \"max\": 240082.96562814713,\n        \"num_unique_values\": 11775,\n        \"samples\": [\n          11049.279731750488,\n          1211.25,\n          122.64000129699707\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"taxes\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 6.0236521209548695,\n        \"min\": 0.0,\n        \"max\": 571.2344818115234,\n        \"num_unique_values\": 459,\n        \"samples\": [\n          2.1600000858306885,\n          3.721808910369873,\n          1.620000034570694\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Remaining nulls:\n",
            "discount    52\n",
            "taxes       52\n",
            "dtype: int64\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Now let's replace the rest of the invalid rows by their mean."
      ],
      "metadata": {
        "id": "-ZE0Ps_tKf4a"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Calculate the mean using ONLY the valid rows\n",
        "mean_disc = sample_neg[neg_cols[0]].mean()\n",
        "mean_tax = sample_neg[neg_cols[1]].mean()\n",
        "# Replace the values in the invalid rows with this calculated mean\n",
        "df_pdv.loc[neg_fill, neg_cols[0]] = mean_disc\n",
        "df_pdv.loc[neg_fill, neg_cols[1]] = mean_tax\n",
        "sample_neg[neg_cols[0]] = sample_neg[neg_cols[0]].fillna(mean_disc)\n",
        "sample_neg[neg_cols[1]] = sample_neg[neg_cols[1]].fillna(mean_tax)\n",
        "# Apply changes\n",
        "df_pdv[neg_cols] = sample_neg[neg_cols]"
      ],
      "metadata": {
        "id": "uQxRNevmFjZa"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "Done that, we need to create a new column called \"unit_price\" that will precify each product unit."
      ],
      "metadata": {
        "id": "Q5D662hAqvaz"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Create a copy of the table\n",
        "df_pdv = df_pdv.copy()\n",
        "# Calculate Implied Unit Price\n",
        "df_pdv[\"unit_price\"] = df_pdv[\"gross_value\"] / df_pdv[\"quantity\"]\n",
        "# Define the columns order\n",
        "ordered_cols = [\"unit_price\", \"gross_value\", \"net_value\",\n",
        "                \"gross_profit\", \"discount\", \"taxes\", \"product_id\", \"category\",\n",
        "                \"description\", \"type\", \"label\", \"subcategory\", \"brand\",\n",
        "                \"manufacturer\", \"pdv_id\", \"premise\", \"pdv_category\", \"zipcode\"]\n",
        "# Get all columns that isn't on ordered list above\n",
        "cols = [c for c in df_pdv.columns if c not in ordered_cols]\n",
        "# Reorder the dataframe\n",
        "df_pdv = df_pdv[cols + ordered_cols]\n",
        "# Visualize the results\n",
        "print(df_pdv.columns)\n",
        "display(df_pdv)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 965
        },
        "id": "rgu1Oj1JmJs_",
        "outputId": "305a082f-dc48-473c-d2e3-d0c0049b0ee3"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Index(['internal_store_id', 'internal_product_id', 'distributor_id',\n",
            "       'transaction_date', 'reference_date', 'quantity', 'unit_price',\n",
            "       'gross_value', 'net_value', 'gross_profit', 'discount', 'taxes',\n",
            "       'product_id', 'category', 'description', 'type', 'label', 'subcategory',\n",
            "       'brand', 'manufacturer', 'pdv_id', 'premise', 'pdv_category',\n",
            "       'zipcode'],\n",
            "      dtype='object')\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "           internal_store_id  internal_product_id distributor_id  \\\n",
              "0        7384367747233276219   328903483604537190              9   \n",
              "1        3536908514005606262  5418855670645487653              5   \n",
              "2        3138231730993449825  1087005562675741887              6   \n",
              "3        3681167389484217654  1401422983880045188              5   \n",
              "4        7762413312337359369  6614994347738381720              4   \n",
              "...                      ...                  ...            ...   \n",
              "6560693  1439579822593789678  2523145330235258825              4   \n",
              "6560694  2357589266242432199  3148628429396585683              4   \n",
              "6560695  7245187752757348055  6668439675743950745              4   \n",
              "6560696  8952609383990245450  3894706280449257667              5   \n",
              "6560697   815150310325179165  3479075165556992938              4   \n",
              "\n",
              "        transaction_date reference_date  quantity  unit_price  gross_value  \\\n",
              "0             2022-07-13     2022-07-01       1.0   38.125000    38.125000   \n",
              "1             2022-03-21     2022-03-01       6.0   17.875000   107.250000   \n",
              "2             2022-09-06     2022-09-01       3.0   18.875000    56.625000   \n",
              "3             2022-09-11     2022-09-01     129.0    8.040000  1037.160023   \n",
              "4             2022-02-18     2022-02-01       1.0   26.230000    26.230000   \n",
              "...                  ...            ...       ...         ...          ...   \n",
              "6560693       2022-12-06     2022-12-01       3.0   21.000000    63.000000   \n",
              "6560694       2022-05-20     2022-05-01       1.0   12.300000    12.300000   \n",
              "6560695       2022-08-17     2022-08-01       1.0   33.849998    33.849998   \n",
              "6560696       2022-02-03     2022-02-01       4.0   18.639000    74.556000   \n",
              "6560697       2022-11-30     2022-11-01       2.0   28.030001    56.060001   \n",
              "\n",
              "           net_value  gross_profit  ...  \\\n",
              "0          37.890625     10.042625  ...   \n",
              "1         106.440002     24.732002  ...   \n",
              "2          56.220001     14.124002  ...   \n",
              "3        1037.160023    156.348026  ...   \n",
              "4          23.950241      6.550241  ...   \n",
              "...              ...           ...  ...   \n",
              "6560693    61.379761     20.879761  ...   \n",
              "6560694    12.300000      3.650000  ...   \n",
              "6560695    31.570240     10.191240  ...   \n",
              "6560696    73.655998     17.991999  ...   \n",
              "6560697    51.500484     14.612485  ...   \n",
              "\n",
              "                                           description  \\\n",
              "0                     BUD LIGHT CHELADA FUEGO 15/25 CN   \n",
              "1                              MICHELOB ULTRA 18/12 CN   \n",
              "2                              BUD LIGHT LIME 18/12 CN   \n",
              "3                      99 BUTTERSCOTCH 12/10/50ML 99PF   \n",
              "4             NB VOODOO RANGER IMPERIAL IPA 15/19.2 CN   \n",
              "...                                                ...   \n",
              "6560693                 DRY COUNTY OLD FASHIONED 750ML   \n",
              "6560694  SPARK ICE + CAFFEINE BLACK RASPBERRY 12/16 CN   \n",
              "6560695               SPATEN PREMIUM LAGER 4/6/12 LNNR   \n",
              "6560696                           BUSCH LIGHT 30/12 CN   \n",
              "6560697      GOOSE ISLAND TROPICAL BEER HUG 15/19.2 CN   \n",
              "\n",
              "                             type         label          subcategory  \\\n",
              "0                         Package          Core            Specialty   \n",
              "1                         Package          Core                Lager   \n",
              "2                         Package          Core                Lager   \n",
              "3               Allocated Spirits  Discontinued  Liqueurs & Cordials   \n",
              "4                         Package          Core                  IPA   \n",
              "...                           ...           ...                  ...   \n",
              "6560693  Distilled Spirits-Domest  Discontinued       Ready-to-Drink   \n",
              "6560694               Non Alcohol          Core                Water   \n",
              "6560695                   Package          Core                Lager   \n",
              "6560696                   Package          Core                Lager   \n",
              "6560697                   Package          Core                  IPA   \n",
              "\n",
              "                                            brand           manufacturer  \\\n",
              "0                         Bud Light Chelada Fuego  AB Anheuser Busch Inc   \n",
              "1                                  Michelob Ultra  AB Anheuser Busch Inc   \n",
              "2                                  Bud Light Lime  AB Anheuser Busch Inc   \n",
              "3                                 99 Butterscotch        Sazerac Spirits   \n",
              "4          New Belgium Voodoo Ranger Imperial IPA         NB New Belgium   \n",
              "...                                           ...                    ...   \n",
              "6560693                  Dry County Old Fashioned     Dry County Spirits   \n",
              "6560694  Sparkling Ice + Caffeine Black Raspberry           Talking Rain   \n",
              "6560695                      Spaten Premium Lager  AB Anheuser Busch Inc   \n",
              "6560696                               Busch Light  AB Anheuser Busch Inc   \n",
              "6560697            Goose Island Tropical Beer Hug  AB Anheuser Busch Inc   \n",
              "\n",
              "                      pdv_id      premise    pdv_category zipcode  \n",
              "0        7384367747233276219  Off Premise  Package/Liquor   80905  \n",
              "1        3536908514005606262  Off Premise  Package/Liquor   80239  \n",
              "2        3138231730993449825  Off Premise  Package/Liquor   80634  \n",
              "3        3681167389484217654  Off Premise  Package/Liquor   80226  \n",
              "4        7762413312337359369  Off Premise     Convenience   30096  \n",
              "...                      ...          ...             ...     ...  \n",
              "6560693  1439579822593789678  Off Premise  Package/Liquor   30071  \n",
              "6560694  2357589266242432199  Off Premise         Grocery   30076  \n",
              "6560695  7245187752757348055  Off Premise         Grocery   30121  \n",
              "6560696  8952609383990245450  Off Premise         Grocery   80602  \n",
              "6560697   815150310325179165  Off Premise     Convenience   30058  \n",
              "\n",
              "[6560698 rows x 24 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-59ce4036-86ad-402d-9acf-4f9979b20c99\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>internal_store_id</th>\n",
              "      <th>internal_product_id</th>\n",
              "      <th>distributor_id</th>\n",
              "      <th>transaction_date</th>\n",
              "      <th>reference_date</th>\n",
              "      <th>quantity</th>\n",
              "      <th>unit_price</th>\n",
              "      <th>gross_value</th>\n",
              "      <th>net_value</th>\n",
              "      <th>gross_profit</th>\n",
              "      <th>...</th>\n",
              "      <th>description</th>\n",
              "      <th>type</th>\n",
              "      <th>label</th>\n",
              "      <th>subcategory</th>\n",
              "      <th>brand</th>\n",
              "      <th>manufacturer</th>\n",
              "      <th>pdv_id</th>\n",
              "      <th>premise</th>\n",
              "      <th>pdv_category</th>\n",
              "      <th>zipcode</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>7384367747233276219</td>\n",
              "      <td>328903483604537190</td>\n",
              "      <td>9</td>\n",
              "      <td>2022-07-13</td>\n",
              "      <td>2022-07-01</td>\n",
              "      <td>1.0</td>\n",
              "      <td>38.125000</td>\n",
              "      <td>38.125000</td>\n",
              "      <td>37.890625</td>\n",
              "      <td>10.042625</td>\n",
              "      <td>...</td>\n",
              "      <td>BUD LIGHT CHELADA FUEGO 15/25 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>Specialty</td>\n",
              "      <td>Bud Light Chelada Fuego</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "      <td>7384367747233276219</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>80905</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>3536908514005606262</td>\n",
              "      <td>5418855670645487653</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-03-21</td>\n",
              "      <td>2022-03-01</td>\n",
              "      <td>6.0</td>\n",
              "      <td>17.875000</td>\n",
              "      <td>107.250000</td>\n",
              "      <td>106.440002</td>\n",
              "      <td>24.732002</td>\n",
              "      <td>...</td>\n",
              "      <td>MICHELOB ULTRA 18/12 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>Lager</td>\n",
              "      <td>Michelob Ultra</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "      <td>3536908514005606262</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>80239</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>3138231730993449825</td>\n",
              "      <td>1087005562675741887</td>\n",
              "      <td>6</td>\n",
              "      <td>2022-09-06</td>\n",
              "      <td>2022-09-01</td>\n",
              "      <td>3.0</td>\n",
              "      <td>18.875000</td>\n",
              "      <td>56.625000</td>\n",
              "      <td>56.220001</td>\n",
              "      <td>14.124002</td>\n",
              "      <td>...</td>\n",
              "      <td>BUD LIGHT LIME 18/12 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>Lager</td>\n",
              "      <td>Bud Light Lime</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "      <td>3138231730993449825</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>80634</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>3681167389484217654</td>\n",
              "      <td>1401422983880045188</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-09-11</td>\n",
              "      <td>2022-09-01</td>\n",
              "      <td>129.0</td>\n",
              "      <td>8.040000</td>\n",
              "      <td>1037.160023</td>\n",
              "      <td>1037.160023</td>\n",
              "      <td>156.348026</td>\n",
              "      <td>...</td>\n",
              "      <td>99 BUTTERSCOTCH 12/10/50ML 99PF</td>\n",
              "      <td>Allocated Spirits</td>\n",
              "      <td>Discontinued</td>\n",
              "      <td>Liqueurs &amp; Cordials</td>\n",
              "      <td>99 Butterscotch</td>\n",
              "      <td>Sazerac Spirits</td>\n",
              "      <td>3681167389484217654</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>80226</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>7762413312337359369</td>\n",
              "      <td>6614994347738381720</td>\n",
              "      <td>4</td>\n",
              "      <td>2022-02-18</td>\n",
              "      <td>2022-02-01</td>\n",
              "      <td>1.0</td>\n",
              "      <td>26.230000</td>\n",
              "      <td>26.230000</td>\n",
              "      <td>23.950241</td>\n",
              "      <td>6.550241</td>\n",
              "      <td>...</td>\n",
              "      <td>NB VOODOO RANGER IMPERIAL IPA 15/19.2 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>IPA</td>\n",
              "      <td>New Belgium Voodoo Ranger Imperial IPA</td>\n",
              "      <td>NB New Belgium</td>\n",
              "      <td>7762413312337359369</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Convenience</td>\n",
              "      <td>30096</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560693</th>\n",
              "      <td>1439579822593789678</td>\n",
              "      <td>2523145330235258825</td>\n",
              "      <td>4</td>\n",
              "      <td>2022-12-06</td>\n",
              "      <td>2022-12-01</td>\n",
              "      <td>3.0</td>\n",
              "      <td>21.000000</td>\n",
              "      <td>63.000000</td>\n",
              "      <td>61.379761</td>\n",
              "      <td>20.879761</td>\n",
              "      <td>...</td>\n",
              "      <td>DRY COUNTY OLD FASHIONED 750ML</td>\n",
              "      <td>Distilled Spirits-Domest</td>\n",
              "      <td>Discontinued</td>\n",
              "      <td>Ready-to-Drink</td>\n",
              "      <td>Dry County Old Fashioned</td>\n",
              "      <td>Dry County Spirits</td>\n",
              "      <td>1439579822593789678</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>30071</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560694</th>\n",
              "      <td>2357589266242432199</td>\n",
              "      <td>3148628429396585683</td>\n",
              "      <td>4</td>\n",
              "      <td>2022-05-20</td>\n",
              "      <td>2022-05-01</td>\n",
              "      <td>1.0</td>\n",
              "      <td>12.300000</td>\n",
              "      <td>12.300000</td>\n",
              "      <td>12.300000</td>\n",
              "      <td>3.650000</td>\n",
              "      <td>...</td>\n",
              "      <td>SPARK ICE + CAFFEINE BLACK RASPBERRY 12/16 CN</td>\n",
              "      <td>Non Alcohol</td>\n",
              "      <td>Core</td>\n",
              "      <td>Water</td>\n",
              "      <td>Sparkling Ice + Caffeine Black Raspberry</td>\n",
              "      <td>Talking Rain</td>\n",
              "      <td>2357589266242432199</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Grocery</td>\n",
              "      <td>30076</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560695</th>\n",
              "      <td>7245187752757348055</td>\n",
              "      <td>6668439675743950745</td>\n",
              "      <td>4</td>\n",
              "      <td>2022-08-17</td>\n",
              "      <td>2022-08-01</td>\n",
              "      <td>1.0</td>\n",
              "      <td>33.849998</td>\n",
              "      <td>33.849998</td>\n",
              "      <td>31.570240</td>\n",
              "      <td>10.191240</td>\n",
              "      <td>...</td>\n",
              "      <td>SPATEN PREMIUM LAGER 4/6/12 LNNR</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>Lager</td>\n",
              "      <td>Spaten Premium Lager</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "      <td>7245187752757348055</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Grocery</td>\n",
              "      <td>30121</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560696</th>\n",
              "      <td>8952609383990245450</td>\n",
              "      <td>3894706280449257667</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-02-03</td>\n",
              "      <td>2022-02-01</td>\n",
              "      <td>4.0</td>\n",
              "      <td>18.639000</td>\n",
              "      <td>74.556000</td>\n",
              "      <td>73.655998</td>\n",
              "      <td>17.991999</td>\n",
              "      <td>...</td>\n",
              "      <td>BUSCH LIGHT 30/12 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>Lager</td>\n",
              "      <td>Busch Light</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "      <td>8952609383990245450</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Grocery</td>\n",
              "      <td>80602</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560697</th>\n",
              "      <td>815150310325179165</td>\n",
              "      <td>3479075165556992938</td>\n",
              "      <td>4</td>\n",
              "      <td>2022-11-30</td>\n",
              "      <td>2022-11-01</td>\n",
              "      <td>2.0</td>\n",
              "      <td>28.030001</td>\n",
              "      <td>56.060001</td>\n",
              "      <td>51.500484</td>\n",
              "      <td>14.612485</td>\n",
              "      <td>...</td>\n",
              "      <td>GOOSE ISLAND TROPICAL BEER HUG 15/19.2 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>IPA</td>\n",
              "      <td>Goose Island Tropical Beer Hug</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "      <td>815150310325179165</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Convenience</td>\n",
              "      <td>30058</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>6560698 rows × 24 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-59ce4036-86ad-402d-9acf-4f9979b20c99')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-59ce4036-86ad-402d-9acf-4f9979b20c99 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-59ce4036-86ad-402d-9acf-4f9979b20c99');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "  <div id=\"id_3795e338-b78a-4d31-9a97-61562dab71d4\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('df_pdv')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_3795e338-b78a-4d31-9a97-61562dab71d4 button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('df_pdv');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "df_pdv"
            }
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Let's see the numeric column metrics again."
      ],
      "metadata": {
        "id": "pG7_v5Z6eHes"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Show all the metrics from numeric columns\n",
        "df_pdv.describe()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 320
        },
        "id": "LLAxFuzkTH2C",
        "outputId": "803b5875-e2be-409e-b530-e597edaca8b9"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "           quantity    unit_price   gross_value     net_value  gross_profit  \\\n",
              "count  6.560698e+06  6.560698e+06  6.560698e+06  6.560698e+06  6.560698e+06   \n",
              "mean   8.319387e+00  2.770572e+01  1.258725e+02  1.221250e+02  2.808858e+01   \n",
              "std    8.072310e+01  4.050610e+01  8.683495e+02  8.671044e+02  2.319841e+02   \n",
              "min    1.000000e+00  5.779844e-09  4.768372e-07  4.768372e-07  0.000000e+00   \n",
              "25%    1.000000e+00  1.975000e+01  2.850000e+01  2.783156e+01  7.363001e+00   \n",
              "50%    2.000000e+00  2.497000e+01  4.376000e+01  4.197536e+01  1.072636e+01   \n",
              "75%    4.000000e+00  3.075000e+01  9.552000e+01  9.107100e+01  2.243400e+01   \n",
              "max    9.423000e+04  4.190701e+04  6.041739e+05  6.041739e+05  2.744160e+05   \n",
              "\n",
              "           discount         taxes  \n",
              "count  6.560698e+06  6.560698e+06  \n",
              "mean   2.300599e+01  3.702134e+00  \n",
              "std    2.582565e+02  1.130124e+01  \n",
              "min    0.000000e+00  0.000000e+00  \n",
              "25%    0.000000e+00  1.800000e-01  \n",
              "50%    2.300000e+00  5.400000e-01  \n",
              "75%    8.400000e+00  3.039677e+00  \n",
              "max    7.077408e+04  4.099409e+03  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-2f65beb2-9b8c-46e0-85ef-8175ca5c95f7\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>quantity</th>\n",
              "      <th>unit_price</th>\n",
              "      <th>gross_value</th>\n",
              "      <th>net_value</th>\n",
              "      <th>gross_profit</th>\n",
              "      <th>discount</th>\n",
              "      <th>taxes</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>count</th>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "      <td>6.560698e+06</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>mean</th>\n",
              "      <td>8.319387e+00</td>\n",
              "      <td>2.770572e+01</td>\n",
              "      <td>1.258725e+02</td>\n",
              "      <td>1.221250e+02</td>\n",
              "      <td>2.808858e+01</td>\n",
              "      <td>2.300599e+01</td>\n",
              "      <td>3.702134e+00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>std</th>\n",
              "      <td>8.072310e+01</td>\n",
              "      <td>4.050610e+01</td>\n",
              "      <td>8.683495e+02</td>\n",
              "      <td>8.671044e+02</td>\n",
              "      <td>2.319841e+02</td>\n",
              "      <td>2.582565e+02</td>\n",
              "      <td>1.130124e+01</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>min</th>\n",
              "      <td>1.000000e+00</td>\n",
              "      <td>5.779844e-09</td>\n",
              "      <td>4.768372e-07</td>\n",
              "      <td>4.768372e-07</td>\n",
              "      <td>0.000000e+00</td>\n",
              "      <td>0.000000e+00</td>\n",
              "      <td>0.000000e+00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>25%</th>\n",
              "      <td>1.000000e+00</td>\n",
              "      <td>1.975000e+01</td>\n",
              "      <td>2.850000e+01</td>\n",
              "      <td>2.783156e+01</td>\n",
              "      <td>7.363001e+00</td>\n",
              "      <td>0.000000e+00</td>\n",
              "      <td>1.800000e-01</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>50%</th>\n",
              "      <td>2.000000e+00</td>\n",
              "      <td>2.497000e+01</td>\n",
              "      <td>4.376000e+01</td>\n",
              "      <td>4.197536e+01</td>\n",
              "      <td>1.072636e+01</td>\n",
              "      <td>2.300000e+00</td>\n",
              "      <td>5.400000e-01</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>75%</th>\n",
              "      <td>4.000000e+00</td>\n",
              "      <td>3.075000e+01</td>\n",
              "      <td>9.552000e+01</td>\n",
              "      <td>9.107100e+01</td>\n",
              "      <td>2.243400e+01</td>\n",
              "      <td>8.400000e+00</td>\n",
              "      <td>3.039677e+00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>max</th>\n",
              "      <td>9.423000e+04</td>\n",
              "      <td>4.190701e+04</td>\n",
              "      <td>6.041739e+05</td>\n",
              "      <td>6.041739e+05</td>\n",
              "      <td>2.744160e+05</td>\n",
              "      <td>7.077408e+04</td>\n",
              "      <td>4.099409e+03</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2f65beb2-9b8c-46e0-85ef-8175ca5c95f7')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-2f65beb2-9b8c-46e0-85ef-8175ca5c95f7 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-2f65beb2-9b8c-46e0-85ef-8175ca5c95f7');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "summary": "{\n  \"name\": \"df_pdv\",\n  \"rows\": 8,\n  \"fields\": [\n    {\n      \"column\": \"quantity\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2315027.5455686655,\n        \"min\": 1.0,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 7,\n        \"samples\": [\n          6560698.0,\n          8.319387140969999,\n          4.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"unit_price\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2317479.485555634,\n        \"min\": 5.779844341856061e-09,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          27.705724704045767,\n          24.969999313354492,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"gross_value\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2298719.5157467565,\n        \"min\": 4.76837158203125e-07,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          125.8724795340903,\n          43.7599983215332,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"net_value\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2298720.177769009,\n        \"min\": 4.76837158203125e-07,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          122.12498182754562,\n          41.97535705566406,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"gross_profit\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2307679.751738692,\n        \"min\": 0.0,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          28.088581536877637,\n          10.726359367370605,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"discount\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2316099.8774360446,\n        \"min\": 0.0,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 7,\n        \"samples\": [\n          6560698.0,\n          23.005993710430836,\n          8.399999618530273\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"taxes\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2319349.466411803,\n        \"min\": 0.0,\n        \"max\": 6560698.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          3.7021335667481186,\n          0.5400000214576721,\n          6560698.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 26
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "As we can see, the metrics are correct, but now we need to see the data type of each column!"
      ],
      "metadata": {
        "id": "stNT37smeNEI"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Ee7BYDV36onO",
        "outputId": "0a536ab3-f639-47ea-b1e9-8d4b457e87cc"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "<class 'pandas.core.frame.DataFrame'>\n",
            "RangeIndex: 6560698 entries, 0 to 6560697\n",
            "Data columns (total 24 columns):\n",
            " #   Column               Dtype  \n",
            "---  ------               -----  \n",
            " 0   internal_store_id    object \n",
            " 1   internal_product_id  object \n",
            " 2   distributor_id       object \n",
            " 3   transaction_date     object \n",
            " 4   reference_date       object \n",
            " 5   quantity             float64\n",
            " 6   unit_price           float64\n",
            " 7   gross_value          float64\n",
            " 8   net_value            float64\n",
            " 9   gross_profit         float64\n",
            " 10  discount             float64\n",
            " 11  taxes                float64\n",
            " 12  product_id           object \n",
            " 13  category             object \n",
            " 14  description          object \n",
            " 15  type                 object \n",
            " 16  label                object \n",
            " 17  subcategory          object \n",
            " 18  brand                object \n",
            " 19  manufacturer         object \n",
            " 20  pdv_id               object \n",
            " 21  premise              object \n",
            " 22  pdv_category         object \n",
            " 23  zipcode              object \n",
            "dtypes: float64(7), object(17)\n",
            "memory usage: 1.2+ GB\n"
          ]
        }
      ],
      "source": [
        "# Show de data type of the dataframe columns\n",
        "df_pdv.info()"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Further, we need to convert all column to their correct data types."
      ],
      "metadata": {
        "id": "hFh-4ZcIl76h"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Defines the columns to be managed\n",
        "cols = df_pdv.columns\n",
        "str_cols = [\"category\", \"description\", \"type\", \"label\", \"subcategory\", \"brand\",\n",
        "            \"manufacturer\", \"premise\", \"pdv_category\"]\n",
        "int_cols = [\"internal_store_id\", \"internal_product_id\", \"distributor_id\",\n",
        "             \"quantity\", \"product_id\", \"pdv_id\", \"zipcode\"]\n",
        "float_cols = [\"unit_price\", \"gross_value\", \"net_value\", \"gross_profit\", \"discount\", \"taxes\"]\n",
        "date_cols = [\"transaction_date\", \"reference_date\"]\n",
        "# Defines the data types to be managed\n",
        "for c in cols:\n",
        "  if c in str_cols:\n",
        "    df_pdv[c] = df_pdv[c].astype(\"string\")\n",
        "  elif c in int_cols:\n",
        "    df_pdv[c] = df_pdv[c].astype(int)\n",
        "  elif c in float_cols:\n",
        "    df_pdv[c] = df_pdv[c].astype(float).round(2)\n",
        "  elif c in date_cols:\n",
        "    df_pdv[c] = pd.to_datetime(df_pdv[c])\n",
        "  print(f\"Column: {c} - Data Type: {df_pdv[c].dtype}\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "pr1PRDr0E8CA",
        "outputId": "727e49f4-49be-41e1-c972-06380f56940e"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Column: internal_store_id - Data Type: int64\n",
            "Column: internal_product_id - Data Type: int64\n",
            "Column: distributor_id - Data Type: int64\n",
            "Column: transaction_date - Data Type: datetime64[ns]\n",
            "Column: reference_date - Data Type: datetime64[ns]\n",
            "Column: quantity - Data Type: int64\n",
            "Column: unit_price - Data Type: float64\n",
            "Column: gross_value - Data Type: float64\n",
            "Column: net_value - Data Type: float64\n",
            "Column: gross_profit - Data Type: float64\n",
            "Column: discount - Data Type: float64\n",
            "Column: taxes - Data Type: float64\n",
            "Column: product_id - Data Type: int64\n",
            "Column: category - Data Type: string\n",
            "Column: description - Data Type: string\n",
            "Column: type - Data Type: string\n",
            "Column: label - Data Type: string\n",
            "Column: subcategory - Data Type: string\n",
            "Column: brand - Data Type: string\n",
            "Column: manufacturer - Data Type: string\n",
            "Column: pdv_id - Data Type: int64\n",
            "Column: premise - Data Type: string\n",
            "Column: pdv_category - Data Type: string\n",
            "Column: zipcode - Data Type: int64\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Let's check the data types again..."
      ],
      "metadata": {
        "id": "TFkaZwztG1Ck"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Show de data type of the dataframe columns\n",
        "df_pdv.info()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "5TK01PqS64pH",
        "outputId": "7d703e4d-aebe-47d3-8b83-ccf17f4e985f"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "<class 'pandas.core.frame.DataFrame'>\n",
            "RangeIndex: 6560698 entries, 0 to 6560697\n",
            "Data columns (total 24 columns):\n",
            " #   Column               Dtype         \n",
            "---  ------               -----         \n",
            " 0   internal_store_id    int64         \n",
            " 1   internal_product_id  int64         \n",
            " 2   distributor_id       int64         \n",
            " 3   transaction_date     datetime64[ns]\n",
            " 4   reference_date       datetime64[ns]\n",
            " 5   quantity             int64         \n",
            " 6   unit_price           float64       \n",
            " 7   gross_value          float64       \n",
            " 8   net_value            float64       \n",
            " 9   gross_profit         float64       \n",
            " 10  discount             float64       \n",
            " 11  taxes                float64       \n",
            " 12  product_id           int64         \n",
            " 13  category             string        \n",
            " 14  description          string        \n",
            " 15  type                 string        \n",
            " 16  label                string        \n",
            " 17  subcategory          string        \n",
            " 18  brand                string        \n",
            " 19  manufacturer         string        \n",
            " 20  pdv_id               int64         \n",
            " 21  premise              string        \n",
            " 22  pdv_category         string        \n",
            " 23  zipcode              int64         \n",
            "dtypes: datetime64[ns](2), float64(6), int64(7), string(9)\n",
            "memory usage: 1.2 GB\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Now that the dataframe is correctly formated, we'll just review the number of rows and removed rows."
      ],
      "metadata": {
        "id": "wJAUEadiHHPB"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "sp_new = df_pdv.shape\n",
        "sp_diff = sp[0] - sp_new[0]\n",
        "print(f\"Dataframe number of rows actually: {sp_new[0]}\")\n",
        "print(f\"Dataframe removed rows: {sp_diff}\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "vdUqNClTHHlk",
        "outputId": "1561cd32-0ddb-4daf-c579-8201b7528282"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Dataframe number of rows actually: 6560698\n",
            "Dataframe removed rows: 0\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "## 1.3) Load"
      ],
      "metadata": {
        "id": "hGTt6zGwJxIg"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "To finalize our first phase, we need to load the dataframe separately. Let's start by spliting them back into the three previous tables."
      ],
      "metadata": {
        "id": "PLpy43bWTMKk"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Splits the dataframe into three\n",
        "df_pdv1 = df_pdv.iloc[:, :12].copy()\n",
        "df_pdv2 = df_pdv.iloc[:, 12:20].copy()\n",
        "df_pdv3 = df_pdv.iloc[:, 20:].copy()\n",
        "# Check the three generated dataframes\n",
        "display(df_pdv1, df_pdv2, df_pdv3)"
      ],
      "metadata": {
        "id": "WCqcByV6LZ0p",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "outputId": "398ca851-fdf1-486e-907a-b1a0f16c44ec"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "           internal_store_id  internal_product_id  distributor_id  \\\n",
              "0        7384367747233276219   328903483604537190               9   \n",
              "1        3536908514005606262  5418855670645487653               5   \n",
              "2        3138231730993449825  1087005562675741887               6   \n",
              "3        3681167389484217654  1401422983880045188               5   \n",
              "4        7762413312337359369  6614994347738381720               4   \n",
              "...                      ...                  ...             ...   \n",
              "6560693  1439579822593789678  2523145330235258825               4   \n",
              "6560694  2357589266242432199  3148628429396585683               4   \n",
              "6560695  7245187752757348055  6668439675743950745               4   \n",
              "6560696  8952609383990245450  3894706280449257667               5   \n",
              "6560697   815150310325179165  3479075165556992938               4   \n",
              "\n",
              "        transaction_date reference_date  quantity  unit_price  gross_value  \\\n",
              "0             2022-07-13     2022-07-01         1       38.12        38.12   \n",
              "1             2022-03-21     2022-03-01         6       17.88       107.25   \n",
              "2             2022-09-06     2022-09-01         3       18.88        56.62   \n",
              "3             2022-09-11     2022-09-01       129        8.04      1037.16   \n",
              "4             2022-02-18     2022-02-01         1       26.23        26.23   \n",
              "...                  ...            ...       ...         ...          ...   \n",
              "6560693       2022-12-06     2022-12-01         3       21.00        63.00   \n",
              "6560694       2022-05-20     2022-05-01         1       12.30        12.30   \n",
              "6560695       2022-08-17     2022-08-01         1       33.85        33.85   \n",
              "6560696       2022-02-03     2022-02-01         4       18.64        74.56   \n",
              "6560697       2022-11-30     2022-11-01         2       28.03        56.06   \n",
              "\n",
              "         net_value  gross_profit  discount  taxes  \n",
              "0            37.89         10.04      3.95   0.23  \n",
              "1           106.44         24.73     17.10   0.81  \n",
              "2            56.22         14.12      5.25   0.41  \n",
              "3          1037.16        156.35    479.88   0.00  \n",
              "4            23.95          6.55      0.00   2.28  \n",
              "...            ...           ...       ...    ...  \n",
              "6560693      61.38         20.88      0.00   1.62  \n",
              "6560694      12.30          3.65      2.80   0.00  \n",
              "6560695      31.57         10.19      0.00   2.28  \n",
              "6560696      73.66         17.99     15.60   0.90  \n",
              "6560697      51.50         14.61      0.00   4.56  \n",
              "\n",
              "[6560698 rows x 12 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-5689c262-81e7-4583-ae7b-03d177bdfd43\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>internal_store_id</th>\n",
              "      <th>internal_product_id</th>\n",
              "      <th>distributor_id</th>\n",
              "      <th>transaction_date</th>\n",
              "      <th>reference_date</th>\n",
              "      <th>quantity</th>\n",
              "      <th>unit_price</th>\n",
              "      <th>gross_value</th>\n",
              "      <th>net_value</th>\n",
              "      <th>gross_profit</th>\n",
              "      <th>discount</th>\n",
              "      <th>taxes</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>7384367747233276219</td>\n",
              "      <td>328903483604537190</td>\n",
              "      <td>9</td>\n",
              "      <td>2022-07-13</td>\n",
              "      <td>2022-07-01</td>\n",
              "      <td>1</td>\n",
              "      <td>38.12</td>\n",
              "      <td>38.12</td>\n",
              "      <td>37.89</td>\n",
              "      <td>10.04</td>\n",
              "      <td>3.95</td>\n",
              "      <td>0.23</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>3536908514005606262</td>\n",
              "      <td>5418855670645487653</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-03-21</td>\n",
              "      <td>2022-03-01</td>\n",
              "      <td>6</td>\n",
              "      <td>17.88</td>\n",
              "      <td>107.25</td>\n",
              "      <td>106.44</td>\n",
              "      <td>24.73</td>\n",
              "      <td>17.10</td>\n",
              "      <td>0.81</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>3138231730993449825</td>\n",
              "      <td>1087005562675741887</td>\n",
              "      <td>6</td>\n",
              "      <td>2022-09-06</td>\n",
              "      <td>2022-09-01</td>\n",
              "      <td>3</td>\n",
              "      <td>18.88</td>\n",
              "      <td>56.62</td>\n",
              "      <td>56.22</td>\n",
              "      <td>14.12</td>\n",
              "      <td>5.25</td>\n",
              "      <td>0.41</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>3681167389484217654</td>\n",
              "      <td>1401422983880045188</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-09-11</td>\n",
              "      <td>2022-09-01</td>\n",
              "      <td>129</td>\n",
              "      <td>8.04</td>\n",
              "      <td>1037.16</td>\n",
              "      <td>1037.16</td>\n",
              "      <td>156.35</td>\n",
              "      <td>479.88</td>\n",
              "      <td>0.00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>7762413312337359369</td>\n",
              "      <td>6614994347738381720</td>\n",
              "      <td>4</td>\n",
              "      <td>2022-02-18</td>\n",
              "      <td>2022-02-01</td>\n",
              "      <td>1</td>\n",
              "      <td>26.23</td>\n",
              "      <td>26.23</td>\n",
              "      <td>23.95</td>\n",
              "      <td>6.55</td>\n",
              "      <td>0.00</td>\n",
              "      <td>2.28</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560693</th>\n",
              "      <td>1439579822593789678</td>\n",
              "      <td>2523145330235258825</td>\n",
              "      <td>4</td>\n",
              "      <td>2022-12-06</td>\n",
              "      <td>2022-12-01</td>\n",
              "      <td>3</td>\n",
              "      <td>21.00</td>\n",
              "      <td>63.00</td>\n",
              "      <td>61.38</td>\n",
              "      <td>20.88</td>\n",
              "      <td>0.00</td>\n",
              "      <td>1.62</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560694</th>\n",
              "      <td>2357589266242432199</td>\n",
              "      <td>3148628429396585683</td>\n",
              "      <td>4</td>\n",
              "      <td>2022-05-20</td>\n",
              "      <td>2022-05-01</td>\n",
              "      <td>1</td>\n",
              "      <td>12.30</td>\n",
              "      <td>12.30</td>\n",
              "      <td>12.30</td>\n",
              "      <td>3.65</td>\n",
              "      <td>2.80</td>\n",
              "      <td>0.00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560695</th>\n",
              "      <td>7245187752757348055</td>\n",
              "      <td>6668439675743950745</td>\n",
              "      <td>4</td>\n",
              "      <td>2022-08-17</td>\n",
              "      <td>2022-08-01</td>\n",
              "      <td>1</td>\n",
              "      <td>33.85</td>\n",
              "      <td>33.85</td>\n",
              "      <td>31.57</td>\n",
              "      <td>10.19</td>\n",
              "      <td>0.00</td>\n",
              "      <td>2.28</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560696</th>\n",
              "      <td>8952609383990245450</td>\n",
              "      <td>3894706280449257667</td>\n",
              "      <td>5</td>\n",
              "      <td>2022-02-03</td>\n",
              "      <td>2022-02-01</td>\n",
              "      <td>4</td>\n",
              "      <td>18.64</td>\n",
              "      <td>74.56</td>\n",
              "      <td>73.66</td>\n",
              "      <td>17.99</td>\n",
              "      <td>15.60</td>\n",
              "      <td>0.90</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560697</th>\n",
              "      <td>815150310325179165</td>\n",
              "      <td>3479075165556992938</td>\n",
              "      <td>4</td>\n",
              "      <td>2022-11-30</td>\n",
              "      <td>2022-11-01</td>\n",
              "      <td>2</td>\n",
              "      <td>28.03</td>\n",
              "      <td>56.06</td>\n",
              "      <td>51.50</td>\n",
              "      <td>14.61</td>\n",
              "      <td>0.00</td>\n",
              "      <td>4.56</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>6560698 rows × 12 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5689c262-81e7-4583-ae7b-03d177bdfd43')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-5689c262-81e7-4583-ae7b-03d177bdfd43 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-5689c262-81e7-4583-ae7b-03d177bdfd43');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-e4050085-6cd8-45fb-8f39-9e7907bdbd15\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-e4050085-6cd8-45fb-8f39-9e7907bdbd15')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-e4050085-6cd8-45fb-8f39-9e7907bdbd15 button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "  <div id=\"id_4e9df5d5-c012-49f3-9680-daa3c6f1e5bf\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('df_pdv1')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_4e9df5d5-c012-49f3-9680-daa3c6f1e5bf button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('df_pdv1');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "df_pdv1"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "                  product_id           category  \\\n",
              "0         328903483604537190            Package   \n",
              "1        5418855670645487653            Package   \n",
              "2        1087005562675741887            Package   \n",
              "3        1401422983880045188  Distilled Spirits   \n",
              "4        6614994347738381720            Package   \n",
              "...                      ...                ...   \n",
              "6560693  2523145330235258825  Distilled Spirits   \n",
              "6560694  3148628429396585683        Non-Alcohol   \n",
              "6560695  6668439675743950745            Package   \n",
              "6560696  3894706280449257667            Package   \n",
              "6560697  3479075165556992938            Package   \n",
              "\n",
              "                                           description  \\\n",
              "0                     BUD LIGHT CHELADA FUEGO 15/25 CN   \n",
              "1                              MICHELOB ULTRA 18/12 CN   \n",
              "2                              BUD LIGHT LIME 18/12 CN   \n",
              "3                      99 BUTTERSCOTCH 12/10/50ML 99PF   \n",
              "4             NB VOODOO RANGER IMPERIAL IPA 15/19.2 CN   \n",
              "...                                                ...   \n",
              "6560693                 DRY COUNTY OLD FASHIONED 750ML   \n",
              "6560694  SPARK ICE + CAFFEINE BLACK RASPBERRY 12/16 CN   \n",
              "6560695               SPATEN PREMIUM LAGER 4/6/12 LNNR   \n",
              "6560696                           BUSCH LIGHT 30/12 CN   \n",
              "6560697      GOOSE ISLAND TROPICAL BEER HUG 15/19.2 CN   \n",
              "\n",
              "                             type         label          subcategory  \\\n",
              "0                         Package          Core            Specialty   \n",
              "1                         Package          Core                Lager   \n",
              "2                         Package          Core                Lager   \n",
              "3               Allocated Spirits  Discontinued  Liqueurs & Cordials   \n",
              "4                         Package          Core                  IPA   \n",
              "...                           ...           ...                  ...   \n",
              "6560693  Distilled Spirits-Domest  Discontinued       Ready-to-Drink   \n",
              "6560694               Non Alcohol          Core                Water   \n",
              "6560695                   Package          Core                Lager   \n",
              "6560696                   Package          Core                Lager   \n",
              "6560697                   Package          Core                  IPA   \n",
              "\n",
              "                                            brand           manufacturer  \n",
              "0                         Bud Light Chelada Fuego  AB Anheuser Busch Inc  \n",
              "1                                  Michelob Ultra  AB Anheuser Busch Inc  \n",
              "2                                  Bud Light Lime  AB Anheuser Busch Inc  \n",
              "3                                 99 Butterscotch        Sazerac Spirits  \n",
              "4          New Belgium Voodoo Ranger Imperial IPA         NB New Belgium  \n",
              "...                                           ...                    ...  \n",
              "6560693                  Dry County Old Fashioned     Dry County Spirits  \n",
              "6560694  Sparkling Ice + Caffeine Black Raspberry           Talking Rain  \n",
              "6560695                      Spaten Premium Lager  AB Anheuser Busch Inc  \n",
              "6560696                               Busch Light  AB Anheuser Busch Inc  \n",
              "6560697            Goose Island Tropical Beer Hug  AB Anheuser Busch Inc  \n",
              "\n",
              "[6560698 rows x 8 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-4f5102cd-e4f8-44bd-858e-f06731317e03\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>product_id</th>\n",
              "      <th>category</th>\n",
              "      <th>description</th>\n",
              "      <th>type</th>\n",
              "      <th>label</th>\n",
              "      <th>subcategory</th>\n",
              "      <th>brand</th>\n",
              "      <th>manufacturer</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>328903483604537190</td>\n",
              "      <td>Package</td>\n",
              "      <td>BUD LIGHT CHELADA FUEGO 15/25 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>Specialty</td>\n",
              "      <td>Bud Light Chelada Fuego</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>5418855670645487653</td>\n",
              "      <td>Package</td>\n",
              "      <td>MICHELOB ULTRA 18/12 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>Lager</td>\n",
              "      <td>Michelob Ultra</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>1087005562675741887</td>\n",
              "      <td>Package</td>\n",
              "      <td>BUD LIGHT LIME 18/12 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>Lager</td>\n",
              "      <td>Bud Light Lime</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>1401422983880045188</td>\n",
              "      <td>Distilled Spirits</td>\n",
              "      <td>99 BUTTERSCOTCH 12/10/50ML 99PF</td>\n",
              "      <td>Allocated Spirits</td>\n",
              "      <td>Discontinued</td>\n",
              "      <td>Liqueurs &amp; Cordials</td>\n",
              "      <td>99 Butterscotch</td>\n",
              "      <td>Sazerac Spirits</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>6614994347738381720</td>\n",
              "      <td>Package</td>\n",
              "      <td>NB VOODOO RANGER IMPERIAL IPA 15/19.2 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>IPA</td>\n",
              "      <td>New Belgium Voodoo Ranger Imperial IPA</td>\n",
              "      <td>NB New Belgium</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560693</th>\n",
              "      <td>2523145330235258825</td>\n",
              "      <td>Distilled Spirits</td>\n",
              "      <td>DRY COUNTY OLD FASHIONED 750ML</td>\n",
              "      <td>Distilled Spirits-Domest</td>\n",
              "      <td>Discontinued</td>\n",
              "      <td>Ready-to-Drink</td>\n",
              "      <td>Dry County Old Fashioned</td>\n",
              "      <td>Dry County Spirits</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560694</th>\n",
              "      <td>3148628429396585683</td>\n",
              "      <td>Non-Alcohol</td>\n",
              "      <td>SPARK ICE + CAFFEINE BLACK RASPBERRY 12/16 CN</td>\n",
              "      <td>Non Alcohol</td>\n",
              "      <td>Core</td>\n",
              "      <td>Water</td>\n",
              "      <td>Sparkling Ice + Caffeine Black Raspberry</td>\n",
              "      <td>Talking Rain</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560695</th>\n",
              "      <td>6668439675743950745</td>\n",
              "      <td>Package</td>\n",
              "      <td>SPATEN PREMIUM LAGER 4/6/12 LNNR</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>Lager</td>\n",
              "      <td>Spaten Premium Lager</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560696</th>\n",
              "      <td>3894706280449257667</td>\n",
              "      <td>Package</td>\n",
              "      <td>BUSCH LIGHT 30/12 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>Lager</td>\n",
              "      <td>Busch Light</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560697</th>\n",
              "      <td>3479075165556992938</td>\n",
              "      <td>Package</td>\n",
              "      <td>GOOSE ISLAND TROPICAL BEER HUG 15/19.2 CN</td>\n",
              "      <td>Package</td>\n",
              "      <td>Core</td>\n",
              "      <td>IPA</td>\n",
              "      <td>Goose Island Tropical Beer Hug</td>\n",
              "      <td>AB Anheuser Busch Inc</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>6560698 rows × 8 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-4f5102cd-e4f8-44bd-858e-f06731317e03')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-4f5102cd-e4f8-44bd-858e-f06731317e03 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-4f5102cd-e4f8-44bd-858e-f06731317e03');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-2494e6a2-edad-4b7c-a386-adb18a7fbd06\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-2494e6a2-edad-4b7c-a386-adb18a7fbd06')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-2494e6a2-edad-4b7c-a386-adb18a7fbd06 button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "  <div id=\"id_ef47b8ea-e424-41a7-8d78-9818f135d70e\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('df_pdv2')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_ef47b8ea-e424-41a7-8d78-9818f135d70e button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('df_pdv2');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "df_pdv2"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "                      pdv_id      premise    pdv_category  zipcode\n",
              "0        7384367747233276219  Off Premise  Package/Liquor    80905\n",
              "1        3536908514005606262  Off Premise  Package/Liquor    80239\n",
              "2        3138231730993449825  Off Premise  Package/Liquor    80634\n",
              "3        3681167389484217654  Off Premise  Package/Liquor    80226\n",
              "4        7762413312337359369  Off Premise     Convenience    30096\n",
              "...                      ...          ...             ...      ...\n",
              "6560693  1439579822593789678  Off Premise  Package/Liquor    30071\n",
              "6560694  2357589266242432199  Off Premise         Grocery    30076\n",
              "6560695  7245187752757348055  Off Premise         Grocery    30121\n",
              "6560696  8952609383990245450  Off Premise         Grocery    80602\n",
              "6560697   815150310325179165  Off Premise     Convenience    30058\n",
              "\n",
              "[6560698 rows x 4 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-14ecfc15-d0cf-4c46-89ad-8c6b5a61e8c9\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>pdv_id</th>\n",
              "      <th>premise</th>\n",
              "      <th>pdv_category</th>\n",
              "      <th>zipcode</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>7384367747233276219</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>80905</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>3536908514005606262</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>80239</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>3138231730993449825</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>80634</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>3681167389484217654</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>80226</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>7762413312337359369</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Convenience</td>\n",
              "      <td>30096</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560693</th>\n",
              "      <td>1439579822593789678</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Package/Liquor</td>\n",
              "      <td>30071</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560694</th>\n",
              "      <td>2357589266242432199</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Grocery</td>\n",
              "      <td>30076</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560695</th>\n",
              "      <td>7245187752757348055</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Grocery</td>\n",
              "      <td>30121</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560696</th>\n",
              "      <td>8952609383990245450</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Grocery</td>\n",
              "      <td>80602</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6560697</th>\n",
              "      <td>815150310325179165</td>\n",
              "      <td>Off Premise</td>\n",
              "      <td>Convenience</td>\n",
              "      <td>30058</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>6560698 rows × 4 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-14ecfc15-d0cf-4c46-89ad-8c6b5a61e8c9')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-14ecfc15-d0cf-4c46-89ad-8c6b5a61e8c9 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-14ecfc15-d0cf-4c46-89ad-8c6b5a61e8c9');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-f21b8a02-dc10-4ff5-af1b-c01a9f1aed5a\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-f21b8a02-dc10-4ff5-af1b-c01a9f1aed5a')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-f21b8a02-dc10-4ff5-af1b-c01a9f1aed5a button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "  <div id=\"id_9cb55c04-ad50-4a1c-8295-887f0f8fdd1c\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('df_pdv3')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_9cb55c04-ad50-4a1c-8295-887f0f8fdd1c button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('df_pdv3');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "df_pdv3"
            }
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Now, we have to convert them back to Parquet and save on disk! We also will save a copy of the merged dataframe to use further."
      ],
      "metadata": {
        "id": "rZ-k5W8oZ61u"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Converts the dataframes back to a Pyarrow Table\n",
        "tb_pdv = pa.Table.from_pandas(df_pdv, preserve_index=False)\n",
        "tb_pdv1 = pa.Table.from_pandas(df_pdv1, preserve_index=False)\n",
        "tb_pdv2 = pa.Table.from_pandas(df_pdv2, preserve_index=False)\n",
        "tb_pdv3 = pa.Table.from_pandas(df_pdv3, preserve_index=False)\n",
        "# Writes on the disk\n",
        "pq.write_table(tb_pdv, \"pdv_table.parquet\")\n",
        "pq.write_table(tb_pdv1, \"sales_transactions.parquet\")\n",
        "pq.write_table(tb_pdv2, \"products_catalog.parquet\")\n",
        "pq.write_table(tb_pdv3, \"sales_points.parquet\")"
      ],
      "metadata": {
        "id": "dgKSaVAKKBXt"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        " As we are executing this code on Google Colab, we need an extra step, download all the three files from there..."
      ],
      "metadata": {
        "id": "4dvluHqVbOza"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Download all the three files from Google Colab Cloud (Google Drive)\n",
        "files.download(\"pdv_table.parquet\")\n",
        "files.download(\"sales_transactions.parquet\")\n",
        "files.download(\"products_catalog.parquet\")\n",
        "files.download(\"sales_points.parquet\")"
      ],
      "metadata": {
        "id": "j6F0vGOtxWzk",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 17
        },
        "outputId": "58eea092-20d6-4b3c-a6cf-58f7d1e2a6ce"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.Javascript object>"
            ],
            "application/javascript": [
              "\n",
              "    async function download(id, filename, size) {\n",
              "      if (!google.colab.kernel.accessAllowed) {\n",
              "        return;\n",
              "      }\n",
              "      const div = document.createElement('div');\n",
              "      const label = document.createElement('label');\n",
              "      label.textContent = `Downloading \"${filename}\": `;\n",
              "      div.appendChild(label);\n",
              "      const progress = document.createElement('progress');\n",
              "      progress.max = size;\n",
              "      div.appendChild(progress);\n",
              "      document.body.appendChild(div);\n",
              "\n",
              "      const buffers = [];\n",
              "      let downloaded = 0;\n",
              "\n",
              "      const channel = await google.colab.kernel.comms.open(id);\n",
              "      // Send a message to notify the kernel that we're ready.\n",
              "      channel.send({})\n",
              "\n",
              "      for await (const message of channel.messages) {\n",
              "        // Send a message to notify the kernel that we're ready.\n",
              "        channel.send({})\n",
              "        if (message.buffers) {\n",
              "          for (const buffer of message.buffers) {\n",
              "            buffers.push(buffer);\n",
              "            downloaded += buffer.byteLength;\n",
              "            progress.value = downloaded;\n",
              "          }\n",
              "        }\n",
              "      }\n",
              "      const blob = new Blob(buffers, {type: 'application/binary'});\n",
              "      const a = document.createElement('a');\n",
              "      a.href = window.URL.createObjectURL(blob);\n",
              "      a.download = filename;\n",
              "      div.appendChild(a);\n",
              "      a.click();\n",
              "      div.remove();\n",
              "    }\n",
              "  "
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.Javascript object>"
            ],
            "application/javascript": [
              "download(\"download_27237e29-37fd-48f1-83d9-82e284069ee3\", \"pdv_table.parquet\", 188308601)"
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.Javascript object>"
            ],
            "application/javascript": [
              "\n",
              "    async function download(id, filename, size) {\n",
              "      if (!google.colab.kernel.accessAllowed) {\n",
              "        return;\n",
              "      }\n",
              "      const div = document.createElement('div');\n",
              "      const label = document.createElement('label');\n",
              "      label.textContent = `Downloading \"${filename}\": `;\n",
              "      div.appendChild(label);\n",
              "      const progress = document.createElement('progress');\n",
              "      progress.max = size;\n",
              "      div.appendChild(progress);\n",
              "      document.body.appendChild(div);\n",
              "\n",
              "      const buffers = [];\n",
              "      let downloaded = 0;\n",
              "\n",
              "      const channel = await google.colab.kernel.comms.open(id);\n",
              "      // Send a message to notify the kernel that we're ready.\n",
              "      channel.send({})\n",
              "\n",
              "      for await (const message of channel.messages) {\n",
              "        // Send a message to notify the kernel that we're ready.\n",
              "        channel.send({})\n",
              "        if (message.buffers) {\n",
              "          for (const buffer of message.buffers) {\n",
              "            buffers.push(buffer);\n",
              "            downloaded += buffer.byteLength;\n",
              "            progress.value = downloaded;\n",
              "          }\n",
              "        }\n",
              "      }\n",
              "      const blob = new Blob(buffers, {type: 'application/binary'});\n",
              "      const a = document.createElement('a');\n",
              "      a.href = window.URL.createObjectURL(blob);\n",
              "      a.download = filename;\n",
              "      div.appendChild(a);\n",
              "      a.click();\n",
              "      div.remove();\n",
              "    }\n",
              "  "
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.Javascript object>"
            ],
            "application/javascript": [
              "download(\"download_230ac33e-0503-435d-b2b1-aef6b28196bb\", \"sales_transactions.parquet\", 113987476)"
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.Javascript object>"
            ],
            "application/javascript": [
              "\n",
              "    async function download(id, filename, size) {\n",
              "      if (!google.colab.kernel.accessAllowed) {\n",
              "        return;\n",
              "      }\n",
              "      const div = document.createElement('div');\n",
              "      const label = document.createElement('label');\n",
              "      label.textContent = `Downloading \"${filename}\": `;\n",
              "      div.appendChild(label);\n",
              "      const progress = document.createElement('progress');\n",
              "      progress.max = size;\n",
              "      div.appendChild(progress);\n",
              "      document.body.appendChild(div);\n",
              "\n",
              "      const buffers = [];\n",
              "      let downloaded = 0;\n",
              "\n",
              "      const channel = await google.colab.kernel.comms.open(id);\n",
              "      // Send a message to notify the kernel that we're ready.\n",
              "      channel.send({})\n",
              "\n",
              "      for await (const message of channel.messages) {\n",
              "        // Send a message to notify the kernel that we're ready.\n",
              "        channel.send({})\n",
              "        if (message.buffers) {\n",
              "          for (const buffer of message.buffers) {\n",
              "            buffers.push(buffer);\n",
              "            downloaded += buffer.byteLength;\n",
              "            progress.value = downloaded;\n",
              "          }\n",
              "        }\n",
              "      }\n",
              "      const blob = new Blob(buffers, {type: 'application/binary'});\n",
              "      const a = document.createElement('a');\n",
              "      a.href = window.URL.createObjectURL(blob);\n",
              "      a.download = filename;\n",
              "      div.appendChild(a);\n",
              "      a.click();\n",
              "      div.remove();\n",
              "    }\n",
              "  "
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.Javascript object>"
            ],
            "application/javascript": [
              "download(\"download_ee1466a1-2e30-4f7e-a713-9ee1bc221a5d\", \"products_catalog.parquet\", 48787139)"
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.Javascript object>"
            ],
            "application/javascript": [
              "\n",
              "    async function download(id, filename, size) {\n",
              "      if (!google.colab.kernel.accessAllowed) {\n",
              "        return;\n",
              "      }\n",
              "      const div = document.createElement('div');\n",
              "      const label = document.createElement('label');\n",
              "      label.textContent = `Downloading \"${filename}\": `;\n",
              "      div.appendChild(label);\n",
              "      const progress = document.createElement('progress');\n",
              "      progress.max = size;\n",
              "      div.appendChild(progress);\n",
              "      document.body.appendChild(div);\n",
              "\n",
              "      const buffers = [];\n",
              "      let downloaded = 0;\n",
              "\n",
              "      const channel = await google.colab.kernel.comms.open(id);\n",
              "      // Send a message to notify the kernel that we're ready.\n",
              "      channel.send({})\n",
              "\n",
              "      for await (const message of channel.messages) {\n",
              "        // Send a message to notify the kernel that we're ready.\n",
              "        channel.send({})\n",
              "        if (message.buffers) {\n",
              "          for (const buffer of message.buffers) {\n",
              "            buffers.push(buffer);\n",
              "            downloaded += buffer.byteLength;\n",
              "            progress.value = downloaded;\n",
              "          }\n",
              "        }\n",
              "      }\n",
              "      const blob = new Blob(buffers, {type: 'application/binary'});\n",
              "      const a = document.createElement('a');\n",
              "      a.href = window.URL.createObjectURL(blob);\n",
              "      a.download = filename;\n",
              "      div.appendChild(a);\n",
              "      a.click();\n",
              "      div.remove();\n",
              "    }\n",
              "  "
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.Javascript object>"
            ],
            "application/javascript": [
              "download(\"download_e4bc1a8c-5523-4310-bd10-a70be4a890da\", \"sales_points.parquet\", 25535409)"
            ]
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Data Ingestion and Preparation is finally done, now let's go to the next step!"
      ],
      "metadata": {
        "id": "M3C9DTUHIXYk"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "# 2) Data Management and Development\n",
        "\n",
        "In this phase, we'll do a wide Data Mining, in especific, EDA (Exploratory Data Analysis)."
      ],
      "metadata": {
        "id": "lM_SKgmgH6Tw"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "## 2.1) Data Structure and Quality"
      ],
      "metadata": {
        "id": "-Nh8imB4LOoO"
      }
    }
  ],
  "metadata": {
    "colab": {
      "provenance": [],
      "collapsed_sections": [
        "1_RN15s5pleN",
        "-Sxvq3AUpkcF",
        "SlxQEgT7I-_8",
        "hGTt6zGwJxIg"
      ]
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "name": "python"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}
